import{J as M,Z as O,M as q,N as J,S as R,w as W,O as Z,P as G}from"./element-plus.38726bbd.js";import{_ as H}from"./index.vue_vue_type_script_setup_true_lang.c6066b25.js";import{r as h,u as I}from"./index.0aa35fa2.js";import{u as k}from"./useLockFn.5a553596.js";import{u as K}from"./usePaging.2d3fb421.js";import{d as Q,_ as X,j as Y,ar as uu,o as i,c as n,V as l,M as o,O as b,u as _,L as C,a as t,U as m,S as D,W as v,aa as g,k as eu,T as a}from"./@vue.581f5ce0.js";import"./lodash-es.b552e321.js";import"./async-validator.fb49d0f5.js";import"./@vueuse.788ba4d8.js";import"./@element-plus.048d13fe.js";import"./dayjs.3bbbdfdd.js";import"./axios.ef5f3479.js";import"./@ctrl.82a509e0.js";import"./@popperjs.36402333.js";import"./escape-html.e5dfadb9.js";import"./normalize-wheel-es.8aeb3683.js";import"./lodash.ccf63c29.js";import"./vue-router.f90229e4.js";import"./pinia.8de84ecb.js";import"./vue-demi.ebc8116b.js";import"./css-color-function.7bd56a8d.js";import"./color.4d72ae60.js";import"./clone.f3914b59.js";import"./color-convert.755d189f.js";import"./color-name.e7a4e1d3.js";import"./color-string.e356f5de.js";import"./balanced-match.d2a36341.js";import"./debug.e3c4d4cf.js";import"./ms.a9ae1d6d.js";import"./vue-drag-resize.3665149e.js";import"./nprogress.db25c43d.js";import"./vue-clipboard3.37da43ca.js";import"./clipboard.51333a27.js";import"./echarts.8d7a50ae.js";import"./zrender.1084fa23.js";import"./tslib.60310f1a.js";import"./highlight.js.4ebdf9a4.js";import"./@highlightjs.18a086c3.js";function tu(p){return h.get({url:"/setting.system.upgrade/lists",params:p})}function ou(p){return h.post({url:"/setting.system.upgrade/downloadPkg",params:p})}function su(p){return h.post({url:"/setting.system.upgrade/upgrade",params:p,timeout:120*1e3})}const iu=t("div",{class:"py-[3px]"},"\u6E29\u99A8\u63D0\u793A\uFF1A",-1),lu=t("div",{class:"py-[3px]"},[a(" 1.\u7248\u672C\u66F4\u65B0\u9700\u8981\u9010\u4E2A\u7248\u672C\u66F4\u65B0\uFF0C "),t("span",{class:"text-[#f56c6c]"}," \u66F4\u65B0\u524D\u8BF7\u5907\u4EFD\u597D\u7CFB\u7EDF\u548C\u6570\u636E\u5E93\uFF0C\u66F4\u65B0\u6210\u529F\u540E\u9700\u8981\u5F3A\u5236\u5237\u65B0\u7AD9\u70B9\uFF1B ")],-1),nu=t("div",{class:"py-[3px]"},"2.\u7CFB\u7EDF\u6CA1\u6709\u505A\u4E8C\u6B21\u5F00\u53D1\uFF0C\u53EF\u4EE5\u76F4\u63A5\u9009\u62E9\u5728\u7EBF\u66F4\u65B0\u529F\u80FD\uFF1B",-1),au=t("div",{class:"py-[3px]"}," 3.\u7CFB\u7EDF\u5DF2\u505A\u4E8C\u6B21\u5F00\u53D1\uFF0C\u8FDB\u884C\u4E86\u529F\u80FD\u4FEE\u6539\uFF0C\u8BF7\u8C28\u614E\u9009\u62E9\u5728\u7EBF\u66F4\u65B0\u529F\u80FD\uFF0C\u63A8\u8350\u4EE5\u66F4\u65B0\u5305\u7684\u5F62\u5F0F\u624B\u52A8\u66F4\u65B0\uFF1B ",-1),ru={class:"flex items-center"},du={class:"mr-2"},Fu=a(" \u6700\u65B0 "),pu={class:""},cu={class:"operation flex flex-wrap"},_u=a(" \u4E00\u952E\u66F4\u65B0 "),mu={class:"flex mt-4 justify-end"},Eu={class:"flex flex-col justify-between items-center"},fu={class:"flex flex-col pb-8"},Bu=a(" \u672A\u505A\u4E8C\u6B21\u5F00\u53D1\uFF0C\u76F4\u63A5\u66F4\u65B0 "),Cu={class:"mt-2.5"},Du=a("\u5DF2\u505A\u4E8C\u6B21\u5F00\u53D1"),vu={class:"mt-2.5"},gu=a(" \u53D6\u6D88\u66F4\u65B0 "),yu={key:0,style:{"text-align":"center"}},bu={key:1,style:{"text-align":"center"}},hu=t("div",null,"\u4E8C\u6B21\u5F00\u53D1\u540E\u8BF7\u8C28\u614E\u4F7F\u7528\u4E00\u952E\u66F4\u65B0\u529F\u80FD\uFF01",-1),Vu=t("div",null,"\u4E8C\u6B21\u5F00\u53D1\u540E\u4E00\u952E\u66F4\u65B0\u5BFC\u81F4\u7684\u7CFB\u7EDF\u95EE\u9898\uFF0C\u5B98\u65B9\u65E0\u6CD5\u5904\u7406\uFF0C\u8BF7\u505A\u597D\u7CFB\u7EDF\u5907\u4EFD\uFF01",-1),xu=[hu,Vu],wu=a(" \u786E\u5B9A\u66F4\u65B0 "),ku=a(" \u53D6\u6D88\u66F4\u65B0 "),Au={key:0,class:"mt-2.5"},Su=a(" \u4E0B\u8F7D\u66F4\u65B0\u5305\uFF0C\u624B\u52A8\u66F4\u65B0 "),Uu={class:"pt-10",style:{height:"200px","text-align":"center"}},Lu={"element-loading-text":"\u7CFB\u7EDF\u66F4\u65B0\u4E2D\uFF0C\u66F4\u65B0\u5B8C\u6BD5\u540E\u4F1A\u81EA\u884C\u5237\u65B0\u9875\u9762 \u5207\u52FF\u5173\u95ED\u7A97\u53E3\u6216\u5237\u65B0\u9875\u9762"},Be=Q({__name:"index",setup(p){const A=I(),u=X({id:"",outerVisible:!1,loading:!1,isSecondaryDev:!1,threeVisible:!1,innerVisible:!1}),{pager:c,getLists:V}=K({fetchFun:tu});k(async(E,s)=>{const B=await ou({id:E,update_type:s});s==6?window.open(B.line,"_blank"):window.location.href=B.line});const S=E=>{u.outerVisible=!0,u.id=E},U=()=>{u.innerVisible=!1,u.threeVisible=!0,N()},L=()=>{u.outerVisible=!1,u.isSecondaryDev=!1,u.innerVisible=!0},$=()=>{u.outerVisible=!1,u.isSecondaryDev=!0,u.innerVisible=!0},{lockFn:N}=k(async()=>{try{u.loading=!0,await su({id:u.id,update_type:1}),location.reload(!0)}catch{}u.threeVisible=!1,u.innerVisible=!1,u.outerVisible=!1});return Y(()=>{V()}),(E,s)=>{const B=O,x=q,f=J,T=R,d=W,P=Z,j=H,y=M,z=uu("perms"),w=G;return i(),n("div",null,[l(x,{class:"!border-none",shadow:"never"},{default:o(()=>[l(B,{class:"text-xxl",type:"warning",closable:!1,"show-icon":""},{title:o(()=>[iu,lu,nu,au]),_:1})]),_:1}),b((i(),C(x,{class:"!border-none mt-4",shadow:"never"},{default:o(()=>[t("div",null,[l(P,{data:_(c).lists,size:"large",border:""},{default:o(()=>[l(f,{prop:"publish_time",label:"\u53D1\u5E03\u65E5\u671F","min-width":"180px"}),l(f,{label:"\u7248\u672C\u53F7","min-width":"160px"},{default:o(e=>[t("div",ru,[t("div",du,m(e.row.version_no),1),e.$index==0&&_(c).page==1?(i(),C(T,{key:0,size:"small",type:"primary"},{default:o(()=>[Fu]),_:1})):D("",!0)]),t("div",pu,m(e.row.version_str),1)]),_:1}),l(f,{prop:"",label:"\u7248\u672C\u5185\u5BB9","min-width":"220px"},{default:o(e=>[(i(!0),n(v,null,g(e.row.add,(r,F)=>(i(),n("div",{class:"",key:F},m(r),1))),128)),(i(!0),n(v,null,g(e.row.optimize,(r,F)=>(i(),n("div",{class:"",key:F},m(r),1))),128)),(i(!0),n(v,null,g(e.row.repair,(r,F)=>(i(),n("div",{class:"",key:F},m(r),1))),128))]),_:1}),l(f,{prop:"notice",label:"\u6CE8\u610F\u4E8B\u9879","min-width":"220px"},{default:o(e=>[(i(!0),n(v,null,g(e.row.notice,(r,F)=>(i(),n("div",{class:"text-[red]",key:F},m(r),1))),128))]),_:1}),_(A).config.agent?D("",!0):(i(),C(f,{key:0,label:"\u64CD\u4F5C",width:"160px",fixed:"right"},{default:o(e=>[t("div",cu,[b((i(),n("div",null,[e.row.able_update==1?(i(),C(d,{key:0,type:"primary",link:"",onClick:r=>S(e.row.id)},{default:o(()=>[_u]),_:2},1032,["onClick"])):D("",!0)])),[[z,["setting.system.upgrade/upgrade"]]])])]),_:1}))]),_:1},8,["data"])]),t("div",mu,[l(j,{modelValue:_(c),"onUpdate:modelValue":s[0]||(s[0]=e=>eu(c)?c.value=e:null),onChange:_(V)},null,8,["modelValue","onChange"])])]),_:1})),[[w,_(c).loading]]),l(y,{modelValue:u.outerVisible,"onUpdate:modelValue":s[2]||(s[2]=e=>u.outerVisible=e),width:"400px",title:"\u7CFB\u7EDF\u662F\u5426\u8FDB\u884C\u4E8C\u6B21\u5F00\u53D1",center:""},{default:o(()=>[t("div",Eu,[t("div",fu,[t("div",null,[l(d,{class:"w-full",type:"primary",onClick:L},{default:o(()=>[Bu]),_:1})]),t("div",Cu,[l(d,{class:"w-full",onClick:$},{default:o(()=>[Du]),_:1})]),t("div",vu,[l(d,{class:"w-full",onClick:s[1]||(s[1]=e=>u.outerVisible=!1)},{default:o(()=>[gu]),_:1})])])])]),_:1},8,["modelValue"]),l(y,{width:"400px",modelValue:u.innerVisible,"onUpdate:modelValue":s[5]||(s[5]=e=>u.innerVisible=e),"append-to-body":"",center:""},{footer:o(()=>[t("div",null,[l(d,{type:"primary",onClick:U},{default:o(()=>[wu]),_:1}),l(d,{onClick:s[3]||(s[3]=e=>u.innerVisible=!1)},{default:o(()=>[ku]),_:1})]),u.isSecondaryDev?(i(),n("div",Au,[l(d,{onClick:s[4]||(s[4]=e=>u.innerVisible=!1)},{default:o(()=>[Su]),_:1})])):D("",!0)]),default:o(()=>[t("div",null,[u.isSecondaryDev==!1?(i(),n("div",yu," \u4E00\u952E\u66F4\u65B0\u5BFC\u81F4\u7684\u7CFB\u7EDF\u95EE\u9898\uFF0C\u6B22\u8FCE\u524D\u5F80\u793E\u533A\u53CD\u9988\uFF0C\u8BF7\u505A\u597D\u7CFB\u7EDF\u5907\u4EFD\uFF01 ")):(i(),n("div",bu,xu))])]),_:1},8,["modelValue"]),l(y,{width:"300px",modelValue:u.threeVisible,"onUpdate:modelValue":s[6]||(s[6]=e=>u.threeVisible=e),"append-to-body":"",title:"\u66F4\u65B0\u4E2D",center:"","close-on-click-modal":!1,"close-on-press-escape":!1},{default:o(()=>[t("div",Uu,[b(t("div",Lu,null,512),[[w,u.loading]])])]),_:1},8,["modelValue"])])}}});export{Be as default};
