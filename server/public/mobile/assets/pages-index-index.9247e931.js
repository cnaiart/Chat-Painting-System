import{d as e,r as l,c as t,w as a,a as s,b as o,o as u,e as n,f as i,g as r,h as p,t as m,u as d,i as c,F as f,j as x,n as _,k as v,l as g,m as y,p as h,S as k,q as b,s as V,I as C,v as w,x as j,N as I,y as L,z as U,A as z,B as S,C as B,D as A,E as D,G as E,H as M}from"./index-c4e9cb21.js";import{_ as F}from"./page-meta.0a6ed5a4.js";import{u as H,_ as N,a as R}from"./chat-scroll-view.9d4619bc.js";import{_ as O}from"./u-icon.9d0b6bc8.js";import{_ as T}from"./tabbar.vue_vue_type_script_setup_true_lang.de757f7b.js";import{g as $}from"./chat.ffb7aceb.js";import{_ as q}from"./u-button.d1dcbae7.js";import{_ as G}from"./u-popup.550d714f.js";import{u as J}from"./useLockFn.bbb1f608.js";import{_ as P}from"./u-input.c26a5a94.js";import{_ as Q}from"./router-navigate.7694f14d.js";import{_ as W}from"./mp-html.30804373.js";import{_ as X}from"./u-empty.8b31fa6b.js";import{_ as Y}from"./_plugin-vue_export-helper.1b428a4d.js";import"./audio-play.6c57b3d3.js";import"./u-loading.5334235e.js";import"./icon_copy.df22fa63.js";import"./useCopy.c5769034.js";import"./text-item.vue_vue_type_script_setup_true_lang.00f45e3c.js";import"./katex.02915daa.js";import"./_commonjsHelpers.02d3be64.js";import"./icon_copy.2cfe0671.js";import"./z-paging.0c0bd55f.js";import"./guided-popup.vue_vue_type_script_setup_true_lang.bed7a27c.js";import"./l-painter-image.fa4c3f7b.js";import"./l-painter.e1bc292c.js";import"./validate.d36d2063.js";import"./u-image.259ae993.js";import"./u-badge.4654495c.js";import"./emitter.1571a5d9.js";const Z=e({__name:"session-item",props:{modelValue:null,name:null,itemId:null},emits:["update:modelValue","edit","delete"],setup(e,{emit:g}){const y=e,h=l(""),k=l(!1),b=t({get:()=>y.modelValue,set(e){g("update:modelValue",e)}}),V=t((()=>b.value===y.itemId)),C=()=>{k.value=!1,g("edit",y.itemId,h.value)};return a((()=>y.modelValue),(()=>{k.value=!1})),a((()=>y.name),(e=>{h.value=e}),{immediate:!0}),(l,t)=>{const a=s(o("u-icon"),O),y=s(o("u-input"),P),w=v;return u(),n(w,{class:_(["px-[20rpx] h-[80rpx] flex items-center rounded-[8rpx] mb-[20rpx] cursor-pointer",{" bg-page":d(V)}]),onClick:t[4]||(t[4]=l=>b.value=e.itemId)},{default:i((()=>[r(a,{name:"chat"}),r(w,{class:"ml-[20rpx] flex-1 min-w-0"},{default:i((()=>[k.value?(u(),n(y,{key:0,height:"50","custom-style":{fontSize:"26rpx"},modelValue:h.value,"onUpdate:modelValue":t[0]||(t[0]=e=>h.value=e),border:""},null,8,["modelValue"])):(u(),n(w,{key:1,class:"line-clamp-1"},{default:i((()=>[p(m(e.name),1)])),_:1}))])),_:1}),d(V)?(u(),c(f,{key:0},[k.value?(u(),c(f,{key:0},[r(w,{class:"cursor-pointer mx-[12rpx] flex h-full",onClick:C},{default:i((()=>[r(a,{name:"checkbox-mark"})])),_:1}),r(w,{class:"cursor-pointer flex h-full",onClick:t[1]||(t[1]=e=>k.value=!1)},{default:i((()=>[r(a,{name:"close"})])),_:1})],64)):(u(),c(f,{key:1},[r(w,{class:"cursor-pointer mr-[12rpx] flex h-full",onClick:t[2]||(t[2]=e=>k.value=!0)},{default:i((()=>[r(a,{name:"edit-pen"})])),_:1}),r(w,{class:"cursor-pointer flex h-full",onClick:t[3]||(t[3]=l=>g("delete",e.itemId))},{default:i((()=>[r(a,{name:"trash"})])),_:1})],64))],64)):x("v-if",!0)])),_:1},8,["class"])}}}),K=e({__name:"session-popup",props:{modelValue:{type:Boolean}},emits:["update:modelValue"],setup(e,{emit:l}){const m=e,x=t({get:()=>m.modelValue,set:e=>{l("update:modelValue",e)}}),{sessionLists:_,sessionAdd:b,sessionEdit:V,sessionDelete:C,sessionClear:w,sessionActive:j}=H(),{lockFn:I,isLock:L}=J((async()=>{await b()})),U=g();return a((()=>U.getChatConfig),(()=>{U.getChatConfig.is_reopen&&(I(),U.getChatConfig.is_reopen=0)}),{immediate:!0}),(e,l)=>{const t=s(o("u-button"),q),a=v,m=k,g=s(o("u-popup"),G);return u(),n(g,{modelValue:d(x),"onUpdate:modelValue":l[1]||(l[1]=e=>h(x)?x.value=e:null),mode:"left",width:"480rpx","safe-area-inset-bottom":""},{default:i((()=>[r(a,{class:"flex flex-col h-full relative z-[9999]"},{default:i((()=>[r(a,{class:"px-[20rpx] py-[20rpx]"},{default:i((()=>[r(t,{type:"primary","custom-style":{width:"100%"},onClick:d(I),loading:d(L)},{default:i((()=>[p(" + 新建会话 ")])),_:1},8,["onClick","loading"])])),_:1}),r(a,{class:"flex-1 min-h-0"},{default:i((()=>[r(m,{"scroll-y":"",class:"h-full"},{default:i((()=>[r(a,{class:"px-[20rpx]"},{default:i((()=>[(u(!0),c(f,null,y(d(_),(e=>(u(),n(a,{key:e.id},{default:i((()=>[r(Z,{modelValue:d(j),"onUpdate:modelValue":l[0]||(l[0]=e=>h(j)?j.value=e:null),"item-id":e.id,name:e.name,onEdit:d(V),onDelete:d(C)},null,8,["modelValue","item-id","name","onEdit","onDelete"])])),_:2},1024)))),128))])),_:1})])),_:1})])),_:1}),r(a,{class:"px-[20rpx] py-[20rpx]"},{default:i((()=>[r(t,{"custom-style":{width:"100%"},onClick:d(w)},{default:i((()=>[p(" 删除所有会话 ")])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1},8,["modelValue"])}}}),ee=e({__name:"follow-official",props:{title:{default:"👉🏻关注公众号，下次访问不迷路"},show:{type:Boolean,default:!1}},setup(e){const t=l(!1),a=()=>{V.set(C,!0,86400),t.value=!1};return b((()=>{t.value=!V.get(C)})),(l,d)=>{const c=v,f=s(o("u-button"),q),_=s(o("router-navigate"),Q),g=s(o("u-icon"),O);return e.show&&t.value?(u(),n(c,{key:0,class:"bg-primary flex px-[20rpx] items-center py-[16rpx]"},{default:i((()=>[r(c,{class:"flex-1 line-clamp-1 min-w-0 text-btn-text"},{default:i((()=>[p(m(e.title),1)])),_:1}),r(_,{to:"/packages/pages/follow_official/follow_official"},{default:i((()=>[r(f,{class:"flex-none",plain:!0,type:"primary",size:"medium",shape:"circle","hover-class":"none","custom-style":{height:"60rpx"}},{default:i((()=>[p(" 前往关注 ")])),_:1})])),_:1}),r(c,{class:"text-btn-text ml-[10rpx]",onClick:w(a,["stop"])},{default:i((()=>[r(g,{name:"close"})])),_:1},8,["onClick"])])),_:1})):x("v-if",!0)}}}),le=e({__name:"notice-popup",setup(e){const c=g(),f=j(),_=l(!1),y=t((()=>c.getBulletinConfig.bulletin_content)),h=t((()=>c.getBulletinConfig.bulletin_title)),b=t((()=>c.getBulletinConfig.is_bulletin));a((()=>[f.isLogin,b.value]),(()=>{b.value&&C(b.value)&&f.isLogin&&(_.value=!0)}),{deep:!0,immediate:!1});const C=e=>{const l=V.get(I),t=(new Date).toDateString(),a=!l||l!==t;return a&&e&&f.isLogin&&V.set(I,t),a};return(e,l)=>{const t=v,a=s(o("mp-html"),W),c=k,f=s(o("u-button"),q),g=s(o("u-popup"),G);return u(),n(g,{modelValue:_.value,"onUpdate:modelValue":l[1]||(l[1]=e=>_.value=e),mode:"center","border-radius":"24"},{default:i((()=>[r(t,{class:"w-[90vw] px-[24rpx]"},{default:i((()=>[r(t,{class:"p-[30rpx] text-lg text-center font-medium"},{default:i((()=>[p(m(d(h)),1)])),_:1}),r(c,{class:"max-h-[768rpx]","scroll-y":""},{default:i((()=>[x(' <u-parse :html="richTextContent"></u-parse> '),r(a,{content:d(y)},null,8,["content"])])),_:1}),r(t,{class:"py-[30rpx] bg-white"},{default:i((()=>[r(f,{type:"primary",style:{height:"82rpx",lineHeight:"82rpx",fontSize:"30rpx",border:"none",borderRadius:"60px"},onClick:l[0]||(l[0]=e=>_.value=!1)},{default:i((()=>[p(" 我知道了 ")])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"])}}}),te=e({__name:"problem-example",props:{data:null},emits:["click-item","show-more"],setup(e,{emit:l}){const a=e,_=e=>e.slice(0,3),g=t((()=>_(a.data)));return(e,t)=>{const a=L,h=v,k=s(o("u-icon"),O);return u(),n(h,{class:"problem-example px-[10rpx]"},{default:i((()=>[r(h,{class:"flex"},{default:i((()=>[(u(!0),c(f,null,y(d(g),(e=>(u(),n(h,{key:e.id,class:"flex-1 mx-[10rpx]"},{default:i((()=>[r(h,{class:"flex flex-col justify-center items-center mb-[20rpx]"},{default:i((()=>[e.image?(u(),n(a,{key:0,class:"w-[88rpx] h-[88rpx]",src:e.image,alt:""},null,8,["src"])):x("v-if",!0),r(h,{class:"text-[30rpx] font-medium mt-[32rpx] line-clamp-1"},{default:i((()=>[p(m(e.name),1)])),_:2},1024)])),_:2},1024),r(h,null,{default:i((()=>[(u(!0),c(f,null,y(_(e.sample),(e=>(u(),n(h,{key:e.id,class:"bg-page mb-[20rpx] px-[20rpx] py-[15rpx] flex justify-center rounded-[12rpx] cursor-pointer",onClick:t=>{return a=e.content,void l("click-item",a);var a}},{default:i((()=>[r(h,{class:"line-clamp-2 text-sm text-center"},{default:i((()=>[p(m(e.content),1)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:2},1024)])),_:2},1024)))),128))])),_:1}),r(h,{class:"py-[10rpx]",onClick:t[0]||(t[0]=e=>l("show-more"))},{default:i((()=>[r(h,{class:"text-sm text-muted flex items-center justify-center"},{default:i((()=>[p(" 查看更多 "),r(k,{name:"arrow-right",size:"26"})])),_:1})])),_:1})])),_:1})}}}),ae=e({__name:"session",props:{modelValue:{type:Boolean}},emits:["update:modelValue"],setup(e,{emit:l}){const a=e,c=t({get:()=>a.modelValue,set:e=>{l("update:modelValue",e)}}),{currentSession:f,sessionAdd:x}=H();return(e,l)=>{const t=s(o("u-icon"),O),a=v;return u(),n(a,{class:"bg-[#333] text-white flex items-center px-[20rpx] py-[24rpx]"},{default:i((()=>[r(t,{name:"list",size:40,onClick:l[0]||(l[0]=e=>c.value=!0)}),r(a,{class:"flex-1 line-clamp-1 ml-[20rpx]"},{default:i((()=>[p(m(d(f)),1)])),_:1}),r(a,{class:"text-xs flex items-center",onClick:d(x)},{default:i((()=>[r(t,{name:"plus-circle",class:"mr-[8rpx]",size:"36"}),p(" 新建 ")])),_:1},8,["onClick"])])),_:1})}}}),se=e({__name:"problem-example-popup",props:{data:null,modelValue:{type:Boolean}},emits:["update:modelValue","click-item"],setup(e,{emit:a}){const x=e,g=t({get:()=>x.modelValue,set:e=>{a("update:modelValue",e)}}),b=l(0),V=t((()=>{var e;return(null==(e=x.data[b.value])?void 0:e.sample)||[]}));return(l,t)=>{const x=v,C=k,w=s(o("u-empty"),X),j=s(o("u-popup"),G);return u(),n(j,{modelValue:d(g),"onUpdate:modelValue":t[0]||(t[0]=e=>h(g)?g.value=e:null),height:"1000rpx",mode:"bottom","safe-area-inset-bottom":"","border-radius":"14",closeable:""},{default:i((()=>[r(x,{class:"py-[30rpx] h-full flex flex-col"},{default:i((()=>[r(x,{class:"text-2xl font-medium px-[30rpx]"},{default:i((()=>[p("问题示例")])),_:1}),r(x,null,{default:i((()=>[r(C,{"scroll-x":!0,class:"whitespace-nowrap"},{default:i((()=>[r(x,{class:"inline-block py-[20rpx]"},{default:i((()=>[r(x,{class:"flex px-[15rpx]"},{default:i((()=>[(u(!0),c(f,null,y(e.data,((e,l)=>(u(),n(x,{class:_(["mx-[15rpx] leading-[72rpx] px-[40rpx] bg-primary-light-9 text-primary rounded-[8rpx]",{"!text-btn-text !bg-primary":b.value==l}]),key:e.id,onClick:e=>b.value=l},{default:i((()=>[r(x,null,{default:i((()=>[p(m(e.name),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1})])),_:1})])),_:1}),r(x,{class:"border-0 border-t border-light border-solid flex-1 min-h-0"},{default:i((()=>[r(C,{class:"h-full","scroll-y":!0},{default:i((()=>[r(x,{class:"px-[30rpx] py-[20rpx]"},{default:i((()=>[d(V).length?(u(!0),c(f,{key:0},y(d(V),(e=>(u(),n(x,{key:e.id,class:"py-[10rpx]"},{default:i((()=>[r(x,{class:"text-center px-[20rpx] bg-page rounded py-[20rpx]",onClick:l=>{return t=e.content,g.value=!1,void a("click-item",t);var t}},{default:i((()=>[p(m(e.content),1)])),_:2},1032,["onClick"])])),_:2},1024)))),128)):(u(),n(x,{key:1,class:"py-[150rpx]"},{default:i((()=>[r(w,{text:"暂无数据",mode:"data"})])),_:1}))])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"])}}}),oe=Y(e({__name:"index",setup(e){const{getSessionLists:t,sessionActive:a}=H(),_=l(!1),y=l(!1),h=l([]),k=l([]),b=U(),V=z({tips:{show:0,title:"",sub_title:""}});U();const C=l(""),w=async()=>{h.value=await $()},j=async()=>{var e;try{const{data:l}=await M({id:8});V.tips=null==(e=JSON.parse(l)[1])?void 0:e.content}catch(l){console.log("获取装修数据失败=>",l)}},I=g(),L=l(!0);return S((()=>{L.value=!1})),B((async()=>{j(),t(),w(),L.value=!0})),A((async()=>{(async()=>{await I.getConfig(),await j(),await t(),await w()})(),D()})),(e,l)=>{const t=s(o("page-meta"),F),g=s(o("model-picker"),N),w=s(o("u-icon"),O),j=v,U=s(o("chat-scroll-view"),R),z=s(o("tabbar"),T);return u(),c(f,null,[r(t,{"page-style":e.$theme.pageStyle},null,8,["page-style"]),r(j,{class:"h-full flex flex-col"},{default:i((()=>[r(j,{class:"flex-1 min-h-0 bg-white"},{default:i((()=>[L.value?(u(),n(U,{key:0,modelValue:k.value,"onUpdate:modelValue":l[4]||(l[4]=e=>k.value=e),ref_key:"chatRef",ref:b,type:1,otherId:d(a),currentModel:C.value,showAdd:!0,safeAreaInsetBottom:!1,avatar:d(I).getChatConfig.chat_logo,bottom:"100rpx"},{top:i((()=>[r(ee,{show:!!d(I).config.is_follow_official,title:d(I).getLoginConfig.involved_text},null,8,["show","title"]),r(ae,{modelValue:_.value,"onUpdate:modelValue":l[0]||(l[0]=e=>_.value=e)},null,8,["modelValue"]),r(g,{modelValue:C.value,"onUpdate:modelValue":l[1]||(l[1]=e=>C.value=e)},null,8,["modelValue"])])),empty:i((()=>[r(j,{class:"w-full"},{default:i((()=>{var e;return[E("div",{class:"my-[60rpx] text-center text-[50rpx] font-medium"},m(d(I).getChatConfig.chat_title),1),h.value.length?(u(),n(te,{key:0,data:h.value,onClickItem:l[2]||(l[2]=e=>d(b).sendLock(e)),onShowMore:l[3]||(l[3]=e=>y.value=!0)},null,8,["data"])):x("v-if",!0),(null==(e=null==V?void 0:V.tips)?void 0:e.show)?(u(),n(j,{key:1,class:"bg-page flex flex-col items-center p-[30rpx] mt-[20rpx] m-[40rpx]"},{default:i((()=>[r(j,{class:"flex items-center"},{default:i((()=>[r(w,{name:"warning",size:40}),r(j,{class:"text-lg ml-[10rpx] break-all"},{default:i((()=>{var e;return[p(m(null==(e=null==V?void 0:V.tips)?void 0:e.title),1)]})),_:1})])),_:1}),r(j,{class:"text-content text-sm mt-[20rpx] break-all"},{default:i((()=>{var e;return[p(m(null==(e=null==V?void 0:V.tips)?void 0:e.sub_title),1)]})),_:1})])),_:1})):x("v-if",!0)]})),_:1})])),_:1},8,["modelValue","otherId","currentModel","avatar"])):x("v-if",!0),x("  会话弹窗  "),r(K,{modelValue:_.value,"onUpdate:modelValue":l[5]||(l[5]=e=>_.value=e)},null,8,["modelValue"]),x("  会话弹窗  "),r(se,{modelValue:y.value,"onUpdate:modelValue":l[6]||(l[6]=e=>y.value=e),data:h.value,onClickItem:l[7]||(l[7]=e=>d(b).sendLock(e))},null,8,["modelValue","data"]),x("  公告弹窗  "),r(le)])),_:1}),x(' <canvas canvas-id="canvasId" id="canvasId"></canvas> '),r(z)])),_:1})],64)}}}),[["__scopeId","data-v-7b7ded2f"]]);export{oe as default};
