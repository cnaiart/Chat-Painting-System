import{_ as e}from"./page-meta.0a6ed5a4.js";import{b9 as t,ap as o,a as l,b as a,o as i,e as n,f as s,g as r,j as u,R as c,n as p,h as d,t as m,k as y,J as f,i as g,F as h,m as S,U as x,V as _,aF as b,d as v,l as C,r as k,c as z,u as w}from"./index-c4e9cb21.js";import{_ as I}from"./u-icon.9d0b6bc8.js";import{_ as B}from"./_plugin-vue_export-helper.1b428a4d.js";import{_ as $}from"./u-input.c26a5a94.js";import{_ as j}from"./u-button.d1dcbae7.js";import{_ as M}from"./u-empty.8b31fa6b.js";import{_ as N}from"./u-popup.550d714f.js";import{_ as T}from"./tabbar.vue_vue_type_script_setup_true_lang.de757f7b.js";import{u as P}from"./useCopy.c5769034.js";import{u as V}from"./useLockFn.bbb1f608.js";import{F}from"./floating-menu.33dda305.js";import"./emitter.1571a5d9.js";import"./u-badge.4654495c.js";const L=B({emits:["close","getMore"],props:{list:{type:Array,default:()=>[]},type:{type:String,default:"warning"},volumeIcon:{type:Boolean,default:!0},moreIcon:{type:Boolean,default:!1},closeIcon:{type:Boolean,default:!1},autoplay:{type:Boolean,default:!0},color:{type:String,default:""},bgColor:{type:String,default:""},show:{type:Boolean,default:!0},fontSize:{type:[Number,String],default:26},volumeSize:{type:[Number,String],default:34},speed:{type:[Number,String],default:160},playState:{type:String,default:"play"},padding:{type:[Number,String],default:"18rpx 24rpx"}},data:()=>({textWidth:0,boxWidth:0,animationDuration:"10s",animationPlayState:"paused",showText:""}),watch:{list:{immediate:!0,handler(e){this.showText=e.join("，"),this.$nextTick((()=>{this.initSize()}))}},playState(e){this.animationPlayState="play"==e?"running":"paused"},speed(e){this.initSize()}},computed:{computeColor(){return this.color?this.color:"none"==this.type?"#606266":this.type},textStyle(){let e={};return this.color?e.color=this.color:"none"==this.type&&(e.color="#606266"),e.fontSize=this.fontSize+"rpx",e},computeBgColor(){return this.bgColor?this.bgColor:"none"==this.type?"transparent":void 0}},mounted(){this.$nextTick((()=>{this.initSize()}))},methods:{initSize(){let e=[],l=new Promise(((e,o)=>{t().in(this).select("#u-notice-content").boundingClientRect().exec((t=>{this.textWidth=t[0].width,e()}))}));e.push(l),Promise.all(e).then((()=>{this.animationDuration=this.textWidth/o(this.speed)+"s",this.animationPlayState="paused",setTimeout((()=>{"play"==this.playState&&this.autoplay&&(this.animationPlayState="running")}),10)}))},click(e){this.$emit("click")},close(){this.$emit("close")},getMore(){this.$emit("getMore")}}},[["render",function(e,t,o,g,h,S){const x=l(a("u-icon"),I),_=y,b=f;return o.show?(i(),n(_,{key:0,class:p(["u-notice-bar",[o.type?`u-type-${o.type}-light-bg`:""]]),style:c({background:S.computeBgColor,padding:o.padding})},{default:s((()=>[r(_,{class:"u-direction-row"},{default:s((()=>[r(_,{class:"u-icon-wrap"},{default:s((()=>[o.volumeIcon?(i(),n(x,{key:0,class:"u-left-icon",name:"volume-fill",size:o.volumeSize,color:S.computeColor},null,8,["size","color"])):u("v-if",!0)])),_:1}),r(_,{class:"u-notice-box",id:"u-notice-box"},{default:s((()=>[r(_,{class:"u-notice-content",id:"u-notice-content",style:c({animationDuration:h.animationDuration,animationPlayState:h.animationPlayState})},{default:s((()=>[r(b,{class:p(["u-notice-text",["u-type-"+o.type]]),onClick:S.click,style:c([S.textStyle])},{default:s((()=>[d(m(h.showText),1)])),_:1},8,["onClick","style","class"])])),_:1},8,["style"])])),_:1}),r(_,{class:"u-icon-wrap"},{default:s((()=>[o.moreIcon?(i(),n(x,{key:0,onClick:S.getMore,class:"u-right-icon",name:"arrow-right",size:26,color:S.computeColor},null,8,["onClick","color"])):u("v-if",!0),o.closeIcon?(i(),n(x,{key:1,onClick:S.close,class:"u-right-icon",name:"close",size:24,color:S.computeColor},null,8,["onClick","color"])):u("v-if",!0)])),_:1})])),_:1})])),_:1},8,["style","class"])):u("v-if",!0)}],["__scopeId","data-v-ffca9182"]]);const R=B({emits:["close","getMore","end"],props:{list:{type:Array,default:()=>[]},type:{type:String,default:"warning"},volumeIcon:{type:Boolean,default:!0},moreIcon:{type:Boolean,default:!1},closeIcon:{type:Boolean,default:!1},autoplay:{type:Boolean,default:!0},color:{type:String,default:""},bgColor:{type:String,default:""},direction:{type:String,default:"row"},show:{type:Boolean,default:!0},fontSize:{type:[Number,String],default:26},duration:{type:[Number,String],default:2e3},volumeSize:{type:[Number,String],default:34},speed:{type:Number,default:160},isCircular:{type:Boolean,default:!0},mode:{type:String,default:"horizontal"},playState:{type:String,default:"play"},disableTouch:{type:Boolean,default:!0},padding:{type:[Number,String],default:"18rpx 24rpx"}},computed:{computeColor(){return this.color?this.color:"none"==this.type?"#606266":this.type},textStyle(){let e={};return this.color?e.color=this.color:"none"==this.type&&(e.color="#606266"),e.fontSize=this.fontSize+"rpx",e},vertical(){return"horizontal"!=this.mode},computeBgColor(){return this.bgColor?this.bgColor:"none"==this.type?"transparent":void 0}},data:()=>({}),methods:{click(e){this.$emit("click",e)},close(){this.$emit("close")},getMore(){this.$emit("getMore")},change(e){e.detail.current==this.list.length-1&&this.$emit("end")}}},[["render",function(e,t,o,f,b,v){const C=l(a("u-icon"),I),k=y,z=x,w=_;return i(),n(k,{class:p(["u-notice-bar",[o.type?`u-type-${o.type}-light-bg`:""]]),style:c({background:v.computeBgColor,padding:o.padding})},{default:s((()=>[r(k,{class:"u-icon-wrap"},{default:s((()=>[o.volumeIcon?(i(),n(C,{key:0,class:"u-left-icon",name:"volume-fill",size:o.volumeSize,color:v.computeColor},null,8,["size","color"])):u("v-if",!0)])),_:1}),r(w,{"disable-touch":o.disableTouch,onChange:v.change,autoplay:o.autoplay&&"play"==o.playState,vertical:v.vertical,circular:"",interval:o.duration,class:"u-swiper"},{default:s((()=>[(i(!0),g(h,null,S(o.list,((e,t)=>(i(),n(z,{key:t,class:"u-swiper-item"},{default:s((()=>[r(k,{class:p(["u-news-item u-line-1",["u-type-"+o.type]]),style:c([v.textStyle]),onClick:e=>v.click(t)},{default:s((()=>[d(m(e),1)])),_:2},1032,["style","onClick","class"])])),_:2},1024)))),128))])),_:1},8,["disable-touch","onChange","autoplay","vertical","interval"]),r(k,{class:"u-icon-wrap"},{default:s((()=>[o.moreIcon?(i(),n(C,{key:0,onClick:v.getMore,class:"u-right-icon",name:"arrow-right",size:26,color:v.computeColor},null,8,["onClick","color"])):u("v-if",!0),o.closeIcon?(i(),n(C,{key:1,onClick:v.close,class:"u-right-icon",name:"close",size:24,color:v.computeColor},null,8,["onClick","color"])):u("v-if",!0)])),_:1})])),_:1},8,["style","class"])}],["__scopeId","data-v-64b50c9f"]]);const W=B({name:"u-notice-bar",emits:["click","close","getMore","end"],props:{list:{type:Array,default:()=>[]},type:{type:String,default:"warning"},volumeIcon:{type:Boolean,default:!0},volumeSize:{type:[Number,String],default:34},moreIcon:{type:Boolean,default:!1},closeIcon:{type:Boolean,default:!1},autoplay:{type:Boolean,default:!0},color:{type:String,default:""},bgColor:{type:String,default:""},mode:{type:String,default:"horizontal"},show:{type:Boolean,default:!0},fontSize:{type:[Number,String],default:28},duration:{type:[Number,String],default:2e3},speed:{type:[Number,String],default:160},isCircular:{type:Boolean,default:!0},playState:{type:String,default:"play"},disableTouch:{type:Boolean,default:!0},borderRadius:{type:[Number,String],default:0},padding:{type:[Number,String],default:"18rpx 24rpx"},noListHidden:{type:Boolean,default:!0}},computed:{isShow(){return 0!=this.show&&(1!=this.noListHidden||0!=this.list.length)}},methods:{click(e){this.$emit("click",e)},close(){this.$emit("close")},getMore(){this.$emit("getMore")},end(){this.$emit("end")}}},[["render",function(e,t,o,r,p,d){const m=l(a("u-row-notice"),L),f=l(a("u-column-notice"),R),g=y;return d.isShow?(i(),n(g,{key:0,class:"u-notice-bar-wrap",style:c({borderRadius:o.borderRadius+"rpx"})},{default:s((()=>["horizontal"==o.mode&&o.isCircular?(i(),n(m,{key:0,type:o.type,color:o.color,bgColor:o.bgColor,list:o.list,volumeIcon:o.volumeIcon,moreIcon:o.moreIcon,volumeSize:o.volumeSize,closeIcon:o.closeIcon,mode:o.mode,fontSize:o.fontSize,speed:o.speed,playState:o.playState,padding:o.padding,onGetMore:d.getMore,onClose:d.close,onClick:d.click},null,8,["type","color","bgColor","list","volumeIcon","moreIcon","volumeSize","closeIcon","mode","fontSize","speed","playState","padding","onGetMore","onClose","onClick"])):u("v-if",!0),"vertical"==o.mode||"horizontal"==o.mode&&!o.isCircular?(i(),n(f,{key:1,type:o.type,color:o.color,bgColor:o.bgColor,list:o.list,volumeIcon:o.volumeIcon,moreIcon:o.moreIcon,closeIcon:o.closeIcon,mode:o.mode,volumeSize:o.volumeSize,"disable-touch":o.disableTouch,fontSize:o.fontSize,duration:o.duration,playState:o.playState,padding:o.padding,onGetMore:d.getMore,onClose:d.close,onClick:d.click,onEnd:d.end},null,8,["type","color","bgColor","list","volumeIcon","moreIcon","closeIcon","mode","volumeSize","disable-touch","fontSize","duration","playState","padding","onGetMore","onClose","onClick","onEnd"])):u("v-if",!0)])),_:1},8,["style"])):u("v-if",!0)}],["__scopeId","data-v-0b852cff"]]);const D=v({__name:"redeem_code",setup(t){const o=C(),c=k(""),p=k(!1),S=k({content:"",failure_time:"",id:"",sn:"",type:"",type_desc:"",valid_time:""}),x=z((()=>o.getCardCodeConfig)),{isLock:_,lockFn:v}=V((async()=>{try{const e=await function(e){return b.get({url:"/cardCode/checkCard",data:e})}({sn:c.value});p.value=!0,S.value=e}catch(e){c.value="",console.log("查询卡密失败=>",e)}})),{isLock:I,lockFn:B}=V((async()=>{try{await(e={sn:c.value},b.post({url:"/cardCode/useCard",data:e})),p.value=!1,uni.$u.toast("兑换成功"),c.value=""}catch(t){console.log("兑换卡密失败=>",t)}var e}));return(t,o)=>{const b=l(a("page-meta"),e),C=y,k=l(a("u-notice-bar"),W),z=l(a("u-input"),$),V=l(a("u-button"),j),L=l(a("u-empty"),M),R=f,D=l(a("u-popup"),N),G=l(a("tabbar"),T);return i(),g(h,null,[r(b,{"page-style":t.$theme.pageStyle},null,8,["page-style"]),r(C,{class:"redeem-code"},{default:s((()=>[w(x).is_show?(i(),n(C,{key:0,class:"flex justify-between bg-primary-light-9 text-primary px-[24rpx] py-[30rpx]"},{default:s((()=>[r(C,{class:"flex flex-1 pr-[20rpx] items-center"},{default:s((()=>[r(C,{class:"w-[124rpx]"},{default:s((()=>[d("购买链接:")])),_:1}),r(C,{class:"flex-1 w-full"},{default:s((()=>[r(k,{padding:"0","bg-color":"none",mode:"horizontal","close-icon":!1,"volume-icon":!1,color:t.$theme.primaryColor,list:[w(x).buy_site]},null,8,["color","list"])])),_:1})])),_:1}),r(C,{class:"underline flex-none",onClick:o[0]||(o[0]=e=>(e=>{const{copy:t}=P();t(e)})(w(x).buy_site))},{default:s((()=>[d("复制链接")])),_:1})])),_:1})):u("v-if",!0),w(x).is_open?(i(),n(C,{key:1,class:"m-[24rpx] px-[30rpx] py-[50rpx] bg-white rounded"},{default:s((()=>[r(C,{class:"py-[10rpx] px-[20rpx] bg-[#f5f5f5] rounded"},{default:s((()=>[r(z,{modelValue:c.value,"onUpdate:modelValue":o[1]||(o[1]=e=>c.value=e),placeholder:"请输入卡密编号"},null,8,["modelValue"])])),_:1}),r(C,{class:"flex items-center justify-center mt-[30px]"},{default:s((()=>[r(V,{type:"primary",shape:"circle",size:"medium",customStyle:{width:"250rpx",height:"80rpx",fontSize:"30rpx"},loading:w(_),onClick:w(v)},{default:s((()=>[d(" 查询 ")])),_:1},8,["loading","onClick"])])),_:1})])),_:1})):(i(),n(C,{key:2,class:"py-[400rpx]"},{default:s((()=>[r(L,{text:"功能未开启"})])),_:1})),r(D,{modelValue:p.value,"onUpdate:modelValue":o[2]||(o[2]=e=>p.value=e),mode:"center","border-radius":"24"},{default:s((()=>[r(C,{class:"w-[600rpx] px-[24rpx]"},{default:s((()=>[r(C,{class:"p-[30rpx] text-lg text-center font-medium"},{default:s((()=>[d(" 查询结果 ")])),_:1}),r(C,{class:"h-[200rpx] px-[20rpx]"},{default:s((()=>[r(C,{class:"flex mt-[20rpx]"},{default:s((()=>[r(R,null,{default:s((()=>[d("卡密类型：")])),_:1}),r(R,{class:"ml-[20rpx]"},{default:s((()=>[d(m(S.value.type_desc),1)])),_:1})])),_:1}),r(C,{class:"flex mt-[20rpx]"},{default:s((()=>[r(R,null,{default:s((()=>[d("卡密面额：")])),_:1}),r(R,{class:"ml-[20rpx]"},{default:s((()=>[d(m(S.value.content),1)])),_:1})])),_:1}),r(C,{class:"flex mt-[20rpx]"},{default:s((()=>[r(R,null,{default:s((()=>[d("兑换时间：")])),_:1}),r(R,{class:"ml-[20rpx]"},{default:s((()=>[d(m(S.value.failure_time),1)])),_:1})])),_:1}),r(C,{class:"flex mt-[20rpx]"},{default:s((()=>[r(R,null,{default:s((()=>[d("有效期至：")])),_:1}),r(R,{class:"ml-[20rpx]"},{default:s((()=>[d(m(S.value.valid_time),1)])),_:1})])),_:1})])),_:1}),r(C,{class:"py-[30rpx] px-[16rpx] bg-white"},{default:s((()=>[r(V,{type:"primary",shape:"circle",size:"medium",customStyle:{width:"100%",height:"82rpx",fontSize:"30rpx"},loading:w(I),onClick:w(B)},{default:s((()=>[d(" 立即兑换 ")])),_:1},8,["loading","onClick"])])),_:1})])),_:1})])),_:1},8,["modelValue"]),u("    底部导航    "),r(G),u("    悬浮菜单    "),r(F)])),_:1})],64)}}});export{D as default};
