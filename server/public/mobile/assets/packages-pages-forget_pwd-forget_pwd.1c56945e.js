import{_ as e}from"./page-meta.0a6ed5a4.js";import{d as a,r as l,c as o,l as t,z as s,A as r,K as u,o as i,i as m,g as d,f as n,h as c,u as p,aA as f,aB as b,n as _,t as v,j as g,F as x,be as w,a0 as y,$ as h,O as j,bi as V,a as $,b as B,k as C,J as P}from"./index-c4e9cb21.js";import{_ as U}from"./u-tabs.30cd1122.js";import{_ as k}from"./u-input.c26a5a94.js";import{_ as S}from"./u-form-item.ae11617d.js";import{_ as A}from"./u-verification-code.3244e1ea.js";import{_ as D}from"./u-form.73f50af5.js";import{_ as F}from"./u-button.d1dcbae7.js";import{F as I}from"./floating-menu.33dda305.js";import{_ as N}from"./_plugin-vue_export-helper.1b428a4d.js";import"./u-badge.4654495c.js";import"./u-icon.9d0b6bc8.js";import"./emitter.1571a5d9.js";const O=N(a({__name:"forget_pwd",setup(a){const N=[{name:"手机号",type:"2"},{name:"邮箱",type:"3"}],O=l(0),R=o((()=>{var e;return(null==(e=T.getLoginConfig)?void 0:e.login_way)||[]})),L=o((()=>{const e=N.filter((e=>R.value.includes(e.type)));return e.length&&(G.scene=e[0].type),e})),T=t(),W=s(),z=l(""),G=r({email:"",mobile:"",password:"",scene:"2",code:"",password_confirm:""}),J=o((()=>uni.$u.test.mobile(G.mobile))),K=o((()=>uni.$u.test.email(G.email))),Q=o((()=>"2"==G.scene)),X=o((()=>"3"==G.scene)),q=e=>{O.value=e,G.scene=N[e].type,1==e?G.mobile="":G.email=""},E=e=>{z.value=e},H=async()=>{var e,a;if(null==(e=W.value)?void 0:e.canGetCode)try{Q.value?await Y():await M(),uni.$u.toast("发送成功"),null==(a=W.value)||a.start()}catch(l){console.log("发送验证码失败=>",l)}},M=async()=>(console.log(K.value),G.email?K.value?void(await w({scene:y.FIND_PASSWORD,email:G.email})):(uni.$u.toast("请输入正确的邮箱地址"),Promise.reject()):(uni.$u.toast("请输入邮箱"),Promise.reject())),Y=async()=>G.mobile?K.value?(uni.$u.toast("请输入正确的手机号"),Promise.reject()):void(await h({scene:y.FIND_PASSWORD,mobile:G.mobile})):(uni.$u.toast("请输入手机号"),Promise.reject()),Z=j(),ee=async()=>!G.mobile&&Q.value?uni.$u.toast("请输入手机号码"):!G.email&&X.value?uni.$u.toast("请输入邮箱"):G.password?G.password_confirm?G.password!=G.password_confirm?uni.$u.toast("两次输入的密码不一致"):(await V(G),void setTimeout((()=>{Z.navigateBack()}),1500)):uni.$u.toast("请输入确认密码"):uni.$u.toast("请输入密码");return u((({type:e})=>{G.scene=e,3==e&&R.value.includes("2")&&(O.value=1)})),(a,l)=>{const o=$(B("page-meta"),e),t=C,s=$(B("u-tabs"),U),r=$(B("u-input"),k),u=$(B("u-form-item"),S),w=$(B("u-verification-code"),A),y=P,h=$(B("u-form"),D),j=$(B("u-button"),F);return i(),m(x,null,[d(o,{"page-style":a.$theme.pageStyle},null,8,["page-style"]),d(t,{class:"register bg-white min-h-full flex flex-col items-center px-[40rpx] pt-[100rpx] box-border"},{default:n((()=>[d(t,{class:"w-full"},{default:n((()=>[d(t,{class:"pb-[40rpx]"},{default:n((()=>[d(t,{class:"text-2xl font-medium mb-[60rpx]"},{default:n((()=>[c("忘记登录密码")])),_:1}),d(s,{list:p(L),"is-scroll":!1,modelValue:O.value,"onUpdate:modelValue":l[0]||(l[0]=e=>O.value=e),"active-color":a.$theme.primaryColor,onChange:q},null,8,["list","modelValue","active-color"])])),_:1}),d(h,{borderBottom:"","label-width":150},{default:n((()=>[f(d(u,{label:"手机号",borderBottom:""},{default:n((()=>[d(r,{class:"flex-1",modelValue:G.mobile,"onUpdate:modelValue":l[1]||(l[1]=e=>G.mobile=e),border:!1,placeholder:"请输入手机号码"},null,8,["modelValue"])])),_:1},512),[[b,p(Q)]]),f(d(u,{label:"邮箱",borderBottom:""},{default:n((()=>[d(r,{class:"flex-1",modelValue:G.email,"onUpdate:modelValue":l[2]||(l[2]=e=>G.email=e),border:!1,placeholder:"请输入邮箱账号"},null,8,["modelValue"])])),_:1},512),[[b,p(X)]]),d(u,{label:"验证码",borderBottom:""},{default:n((()=>[d(r,{class:"flex-1",modelValue:G.code,"onUpdate:modelValue":l[3]||(l[3]=e=>G.code=e),placeholder:"请输入验证码",border:!1},null,8,["modelValue"]),d(t,{class:"border-l border-solid border-0 border-light pl-3 text-muted leading-4 ml-3 w-[180rpx]",onClick:H},{default:n((()=>[d(w,{ref_key:"uCodeRef",ref:W,seconds:60,onChange:E,"change-text":"x秒"},null,512),d(y,{class:_(["text-muted",{"text-primary":p(J)&&p(Q)||p(K)&&p(X)}])},{default:n((()=>[c(v(z.value),1)])),_:1},8,["class"])])),_:1})])),_:1}),d(u,{label:"新密码",borderBottom:""},{default:n((()=>[d(r,{class:"flex-1",type:"password",modelValue:G.password,"onUpdate:modelValue":l[4]||(l[4]=e=>G.password=e),placeholder:"6-20位数字+字母或符号组合",border:!1},null,8,["modelValue"])])),_:1}),d(u,{label:"确认密码",borderBottom:""},{default:n((()=>[d(r,{class:"flex-1",type:"password",modelValue:G.password_confirm,"onUpdate:modelValue":l[5]||(l[5]=e=>G.password_confirm=e),placeholder:"再次输入新密码",border:!1},null,8,["modelValue"])])),_:1})])),_:1}),d(t,{class:"mt-[100rpx]"},{default:n((()=>[d(j,{type:"primary",shape:"circle",onClick:ee},{default:n((()=>[c(" 确定 ")])),_:1})])),_:1})])),_:1}),g("    悬浮菜单    "),d(I)])),_:1})],64)}}}),[["__scopeId","data-v-9b6c6a0f"]]);export{O as default};
