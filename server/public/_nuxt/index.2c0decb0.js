import{_ as he}from"./index.vue.3dfb5dc9.js";import{ak as ve,bi as we,T as F,b$ as be,q as C,a1 as O,a as ae,s as xe,cU as ke,o as v,h as b,F as L,r as re,G as Q,e as c,N as Ce,b as Se,O as Ae,S as W,C as G,f as h,w as N,u as m,aD as Ee,Q as Ie,y as A,i as q,ad as Pe,k as Y,t as H,cV as Te,c as Ne,H as Ve,E as De,j as Le,p as ze,l as Be}from"./entry.c7e0e7b4.js";import{E as Re}from"./index.7b10e937.js";import{E as Oe}from"./index.aad710b7.js";import{E as He}from"./index.67b2792c.js";import{t as Z,g as Ke,E as Ue,a as Me}from"./index.0b9306dd.js";/* empty css                 */import"./el-tooltip.4ed993c7.js";/* empty css                  *//* empty css                  *//* empty css                        *//* empty css                */import{c as $e}from"./index.fa4f9017.js";import{e as je}from"./index.cb3770be.js";import{_ as le}from"./_plugin-vue_export-helper.c27b6911.js";import{e as Fe}from"./empty_news.b8b25207.js";import{g as Qe,a as We,d as Ge}from"./square.fc2940e6.js";import{u as qe}from"./useCopy.162cbe26.js";import{_ as Ye}from"./posterPop.vue.fb684e9e.js";import Ze from"./image.57ed1fed.js";import"./debounce.2af106a8.js";import"./el-divider.ee6e1291.js";import"./index.ade63ee3.js";import"./index.ae48457a.js";import"./index.222a6e13.js";import"./refs.94480413.js";/* empty css                  *//* empty css                     */import"./download.76c7fb53.js";import"./qrcode.vue.esm.3fb480da.js";const x="ElInfiniteScroll",Xe=50,Je=200,et=0,tt={delay:{type:Number,default:Je},distance:{type:Number,default:et},disabled:{type:Boolean,default:!1},immediate:{type:Boolean,default:!0}},$=(e,t)=>Object.entries(tt).reduce((s,[o,r])=>{var l,n;const{type:i,default:f}=r,u=e.getAttribute(`infinite-scroll-${o}`);let g=(n=(l=t[u])!=null?l:u)!=null?n:f;return g=g==="false"?!1:g,g=i(g),s[o]=Number.isNaN(g)?f:g,s},{}),ce=e=>{const{observer:t}=e[x];t&&(t.disconnect(),delete e[x].observer)},nt=(e,t)=>{const{container:s,containerEl:o,instance:r,observer:l,lastScrollTop:n}=e[x],{disabled:i,distance:f}=$(e,r),{clientHeight:u,scrollHeight:g,scrollTop:p}=o,y=p-n;if(e[x].lastScrollTop=p,l||i||y<0)return;let k=!1;if(s===e)k=g-(u+p)<=f;else{const{clientTop:S,scrollHeight:w}=e,E=Ke(e,o);k=p+u>=E+S+w-f}k&&t.call(r)};function K(e,t){const{containerEl:s,instance:o}=e[x],{disabled:r}=$(e,o);r||s.clientHeight===0||(s.scrollHeight<=s.clientHeight?t.call(o):ce(e))}const ot={async mounted(e,t){const{instance:s,value:o}=t;ve(o)||we(x,"'v-infinite-scroll' binding value must be a function"),await F();const{delay:r,immediate:l}=$(e,s),n=be(e,!0),i=n===window?document.documentElement:n,f=Z(nt.bind(null,e,o),r);if(n){if(e[x]={instance:s,container:n,containerEl:i,delay:r,cb:o,onScroll:f,lastScrollTop:i.scrollTop},l){const u=new MutationObserver(Z(K.bind(null,e,o),Xe));e[x].observer=u,u.observe(e,{childList:!0,subtree:!0}),K(e,o)}n.addEventListener("scroll",f)}},unmounted(e){const{container:t,onScroll:s}=e[x];t==null||t.removeEventListener("scroll",s),ce(e)},async updated(e){if(!e[x])await F();else{const{containerEl:t,cb:s,observer:o}=e[x];t.clientHeight&&o&&K(e,s)}}},M=ot;M.install=e=>{e.directive("InfiniteScroll",M)};const st=M,it=({breakpoints:e,wrapperWidth:t,gutter:s,hasAroundGutter:o,initWidth:r})=>{const l=Object.keys(e).map(u=>Number(u)).sort((u,g)=>u-g);let n=t,i=!1;for(const u of l)if(t<=u){n=u,i=!0;break}if(!i)return r;const f=e[n].rowPerView;return o?(t-s)/f-s:(t-(f-1)*s)/f};function at(e){const t=C(0),s=C(null);$e(s,n=>{const i=n[0],{width:f}=i.contentRect;t.value=f});const o=O(()=>it({wrapperWidth:t.value,breakpoints:e.breakpoints,gutter:e.gutter,hasAroundGutter:e.hasAroundGutter,initWidth:e.width})),r=O(()=>{const n=e.hasAroundGutter?-e.gutter:e.gutter;return Math.floor((t.value+n)/(o.value+e.gutter))}),l=O(()=>{const n=e.hasAroundGutter?e.gutter:-e.gutter,i=r.value*(o.value+e.gutter)+n;return(t.value-i)/2});return{waterfallWrapper:s,wrapperWidth:t,colWidth:o,cols:r,offsetX:l}}function ue(e,t){return new RegExp(`(^|\\s)${t}(\\s|$)`).test(e.className)}function X(e,t){if(ue(e,t))return;const s=e.className.split(/\s+/);s.push(t),e.className=s.join(" ")}const rt=document.createElement("div").style,U=(()=>{const e={webkit:"webkitTransform",Moz:"MozTransform",O:"OTransform",ms:"msTransform",standard:"transform"};for(const t in e){const s=e[t];if(rt[s]!==void 0)return t}return!1})();function V(e){return U===!1?!1:U==="standard"?e:U+e.charAt(0).toUpperCase()+e.substr(1)}const J=V("transform"),ee=V("animation-duration"),te=V("animation-delay"),ne=V("transition"),oe=V("animation-fill-mode");function lt(e,t,s,o,r){const l=C([]),n=C(0),i=p=>{const y=e.hasAroundGutter?p+1:p;return e.gutter*y+t.value*p+o.value},f=()=>{l.value=new Array(s.value).fill(e.hasAroundGutter?e.gutter:0)},u=ct(e);return{wrapperHeight:n,layoutHandle:async()=>{f();const p=[];if(r&&r.value&&r.value.childNodes.forEach(y=>{y.className==="waterfall-item"&&p.push(y)}),p.length===0)return!1;for(let y=0;y<p.length;y++){const k=p[y],S=Math.min.apply(null,l.value),w=l.value.indexOf(S),E=i(w),I=k.style;J&&(I[J]=`translate3d(${E}px,${S}px, 0)`),I.width=`${t.value}px`;const{height:d}=k.getBoundingClientRect();l.value[w]+=d+e.gutter,u(k,()=>{ne&&(I[ne]=`transform ${e.animationDuration/1e3}s`)})}n.value=Math.max.apply(null,l.value)}}}function ct(e){return(t,s)=>{const o=t.firstChild;if(o&&!ue(o,e.animationPrefix)){const r=`${e.animationDuration/1e3}s`,l=`${e.animationDelay/1e3}s`,n=o.style;n.visibility="visible",ee&&(n[ee]=r),te&&(n[te]=l),oe&&(n[oe]="both"),X(o,e.animationPrefix),X(o,e.animationEffect),s&&setTimeout(()=>{s()},e.animationDuration+e.animationDelay)}}}const j=ae({props:{list:{type:Array,default:()=>[]},rowKey:{type:String,default:"id"},imgSelector:{type:String,default:"src"},width:{type:Number,default:200},breakpoints:{type:Object,default:()=>({1200:{rowPerView:3},800:{rowPerView:2},500:{rowPerView:1}})},gutter:{type:Number,default:10},hasAroundGutter:{type:Boolean,default:!0},animationPrefix:{type:String,default:"animate__animated"},animationEffect:{type:String,default:"fadeIn"},animationDuration:{type:Number,default:1e3},animationDelay:{type:Number,default:300},backgroundColor:{type:String,default:"#fff"},delay:{type:Number,default:300}},setup(e){const{waterfallWrapper:t,wrapperWidth:s,colWidth:o,cols:r,offsetX:l}=at(e),{wrapperHeight:n,layoutHandle:i}=lt(e,o,r,l,t),f=je(()=>{i()},e.delay);return xe(()=>[s,o,e.list],()=>{s.value>0&&f()},{deep:!0}),{colWidth:o,waterfallWrapper:t,wrapperHeight:n,getKey:(g,p)=>g[e.rowKey]||p,renderer:f}}}),se=()=>{ke(e=>({"6f410b0f":e.backgroundColor}))},ie=j.setup;j.setup=ie?(e,t)=>(se(),ie(e,t)):se;const ut={class:"waterfall-card"};function dt(e,t,s,o,r,l){return v(),b("div",{ref:"waterfallWrapper",class:"waterfall-list",style:Q({height:`${e.wrapperHeight}px`})},[(v(!0),b(L,null,re(e.list,(n,i)=>(v(),b("div",{key:e.getKey(n,i),class:"waterfall-item",style:Q({"--col-width":e.colWidth})},[c("div",ut,[Ce(e.$slots,"item",{item:n,index:i},void 0,!0)])],4))),128))],4)}const ft=le(j,[["render",dt],["__scopeId","data-v-dd68cf8c"]]),mt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAQAAADZc7J/AAACpUlEQVR42o2VTYgcRRiGn6rudd0c1CCimI1sQBRFV+MfeFDwIhLUi6BkjSAe49mfU64ePHkQLyoS0Bxkyc8toAREPIqKOeii5CCCLGQRs7uO09WPTfWSZrpnh3lehqqu+ebl+xmqMYjHPOuWWs+QTcTZJhKjdEJ80znJNqfE0BkEj3Gekl85xwbbFMiQQOIAD/A8dwNrnKEg0eK6uuE9vdSGCuKKl9WfvKHLglz7++KiRaMFS9lHhfiaOvLebBANUnIz8AtQkQhIze0s71PImERNweOU/M4uAciNOZ79g7jsB25ZW5mmqrIhr1d8y2hoDU5ITv1Ov89f16bpytbVXoR+KCUA0vI2R0l8zmmuUiDTCVQc4h2e4iTftRm8KuIdXlU/E0MjZiiKB/1R/TrScYibgC+AkkCkU0Ex8QyLbHEeeLKkQwI1m0CFdDSn9BnTzm4pTgQCRNpdhxzm4MRptzcymwg8xLdc2K+pJbMJwMPcxa0sskMYmsSZPy4aQQJqCsjPYf4MJF1vWMz7hPOWEJCjPEhil6dz3CvsUlDzFZuEvkEYFFZxmHWOUBMBWORTIFFwkeew34N6kDxc409qtpt1BMB2Fs0pxH4GSwwNtniGBSLXeINP2GGFfyiRUdvSzuBvbmF1aiHjRgXwLyA7jPhv2hgvAS+wAiQmCVkQgURoT4YGH1NxhAu8zH09f7OgBgqkPekjnlLT3qfyUTFOXKW3edHTxsH9eEKt2+DjXna8Z/DYlPs5NmJgsKbWMU/6DI9wP69TAxXg4E/Vo5tdCUhkzAZLJBZY4QcWSPQpoCNHrAKb2OmAV9RvmpU5rrQn/ENdD3bzqHmX94Cf+ZLf2B+5kVVeYpkRLzLR78KP8jTmo/KkDFNb85I7M1/1Sf3Lcz4rhv8Bzxm26+YGMrgAAAAASUVORK5CYII=",D=e=>(ze("data-v-52402bcc"),e=e(),Be(),e),pt={class:"app"},_t={class:"header flex flex-col items-center"},gt=D(()=>c("div",{class:"title"},"绘画广场",-1)),yt={class:"search w-[600px] mt-[30px]"},ht={class:"nav flex mt-[30px]"},vt=D(()=>c("div",{class:"text-[18px] text-[#333333] font-medium leading-[40px]"}," 分类： ",-1)),wt={class:"category-list flex-1 ml-[10px]"},bt=["onClick"],xt={class:"main mt-[10px]"},kt=["infinite-scroll-disabled"],Ct={class:"image-payload h-full w-full relative text-sm"},St={class:"image-bg"},At=["onClick"],Et=["onClick"],It={class:"text-center leading-[38px]"},Pt={class:"image-content"},Tt=["onClick"],Nt={class:"flex justify-between mt-[10px]"},Vt={class:"flex items-center"},Dt={class:"text-[#BBBBBB] ml-[6px] w-[80px] truncate"},Lt=["onClick"],zt=D(()=>c("p",{class:"text-white ml-[6px]"}," 复制 ",-1)),Bt={key:0,class:"flex justify-center items-center mt-[50px]"},Rt=D(()=>c("span",{class:"mt-[4px] ml-[10px] text-[#999999]"},"加载中...",-1)),Ot={key:1,class:"flex justify-center items-center mt-[50px]"},Ht=D(()=>c("span",{class:"mt-[4px] ml-[10px] text-[#999999]"}," --- 没有更多了 --- ",-1)),Kt=[Ht],Ut=ae({__name:"index",setup(e){const{copy:t}=qe(),s=Se(),o=Ae();C(!1);const r=W(),l=W(null),n=G({keyword:"",page_no:0,page_size:20,category_id:""}),i=G({more:!0,loading:!1,lists:[]}),f=C([{name:"全部",id:""}]),u=C([]),g={4e3:{rowPerView:8},2e3:{rowPerView:6},1800:{rowPerView:6},1600:{rowPerView:5},1440:{rowPerView:5},1360:{rowPerView:5},1280:{rowPerView:4},1024:{rowPerView:3}},p=()=>{var d;(d=l==null?void 0:l.value)==null||d.renderer()},y=()=>{i.more=!0,n.page_no=0},k=d=>{n.category_id!==d&&(n.category_id=d,y(),w())},S=async()=>{try{const d=await Qe();f.value=[{name:"全部",id:""},...d]}catch(d){console.log("获取分类错误=>",d)}},w=async()=>{if(!i.loading){if(i.more)n.page_no+=1;else return;i.loading=!0;try{const d=await We(n),{lists:_,page_no:P,page_size:z,count:B}=d;P*z>B&&(i.more=!1),P==1?i.lists=_:i.lists=[...i.lists,..._],setTimeout(()=>i.loading=!1,500)}catch(d){i.loading=!1,console.log("获取绘画广场列表错误=>",d)}}},E=async d=>{if(!o.isLogin){o.toggleShowLogin(!0);return}try{await Ge({id:d.id,praise:d.is_praise?0:1}),n.category_id===0?(y(),w()):d.is_praise=d.is_praise?0:1}catch(_){console.error(_)}},I=d=>{if(!o.isLogin){o.toggleShowLogin(!0);return}r.value.open(d)};return S(),w(),(d,_)=>{const P=he,z=Ve,B=Re,de=Oe,fe=He,me=Ue,pe=De,_e=Le,ge=Me,ye=st;return v(),b("div",pt,[h(_e,{name:"app"},{default:N(()=>[c("div",_t,[gt,c("div",yt,[h(z,{modelValue:m(n).keyword,"onUpdate:modelValue":_[2]||(_[2]=a=>m(n).keyword=a),placeholder:"请输入描述词搜索",onKeydown:_[3]||(_[3]=Ee(()=>{y(),w()},["enter"]))},{suffix:N(()=>[m(n).keyword?(v(),b("div",{key:0,class:"cursor-pointer",onClick:_[0]||(_[0]=Ie(()=>{m(n).keyword="",w()},["stop"]))}," 清空 ")):A("",!0),c("div",{class:"w-[40px] flex justify-center items-center cursor-pointer",onClick:_[1]||(_[1]=()=>{y(),w()})},[h(P,{size:"18",name:"el-icon-Search",color:"#828282"})])]),_:1},8,["modelValue"])])]),c("div",ht,[vt,c("div",wt,[(v(!0),b(L,null,re(m(f),a=>(v(),b("div",{key:a.id,class:Y(["category-item",{"category-item--active":a.id===m(n).category_id}]),onClick:R=>k(a.id)},H(a.name),11,bt))),128))])]),c("div",xt,[q(h(B,{class:"mt-[50px]","image-size":250,image:m(Fe),description:"暂时没有绘画哦，快去生成试试吧"},null,8,["image"]),[[Pe,!m(i).lists.length&&!m(i).loading]]),q((v(),b("div",{"infinite-scroll-delay":200,"infinite-scroll-distance":400,"infinite-scroll-disabled":!m(i).more},[m(i).lists.length?(v(),b(L,{key:0},[h(ft,{ref_key:"waterFull",ref:l,delay:100,list:m(i).lists,width:326,gutter:20,animationDelay:0,animationDuration:0,backgroundColor:"none",animationPrefix:"none",animated:"none",animationEffect:"none",breakpoints:g},{item:N(({item:a})=>{var R;return[c("div",Ct,[c("div",St,[h(Ze,{thumbnail:a.thumbnail,image:(a==null?void 0:a.image)||(a==null?void 0:a.image_url),onRefresh:p,onOnClick:_[4]||(_[4]=T=>u.value=T)},null,8,["thumbnail","image"])]),c("div",{class:"image-praise relative",onClick:T=>E(a)},[c("div",{class:Y(["praise-animate",a.is_praise?"praise-entry":"praise-leave"])},null,2)],8,At),h(de,{effect:"dark",content:"生成海报",placement:"top"},{default:N(()=>[c("div",{class:"image-poster relative",onClick:T=>I(a)},[c("div",It,[h(P,{size:"16px",color:"#ffffff",name:"el-icon-Picture"})])],8,Et)]),_:2},1024),c("div",Pt,[c("p",{class:"text-white line-clamp-2",onClick:T=>m(t)(a.original_prompts.prompt)},H((a==null?void 0:a.prompts_cn)||(a==null?void 0:a.original_prompts.prompt)),9,Tt),c("div",Nt,[c("div",Vt,[m(s).getDrawSquareConfig.is_show_user?(v(),b(L,{key:0},[h(fe,{size:28,src:(R=a==null?void 0:a.user_info)==null?void 0:R.image},null,8,["src"]),c("p",Dt,H(a.user_info.name),1)],64)):A("",!0)]),c("div",{class:"flex items-center",onClick:T=>m(t)(a.prompts)},[h(me,{class:"w-[16px] h-[16px]",src:m(mt)},null,8,["src"]),zt],8,Lt)])])])]}),_:1},8,["list"]),m(i).loading?(v(),b("div",Bt,[h(pe,{size:"25",class:"is-loading"},{default:N(()=>[h(m(Te))]),_:1}),Rt])):A("",!0),!m(i).more&&!m(i).loading?(v(),b("div",Ot,Kt)):A("",!0)],64)):A("",!0)],8,kt)),[[ye,w]])])]),_:1}),h(Ye,{ref_key:"popRef",ref:r},null,512),m(u).length?(v(),Ne(ge,{key:0,"url-list":m(u),"hide-on-click-modal":!0,onClose:_[5]||(_[5]=a=>u.value=[])},null,8,["url-list"])):A("",!0)])}}});const vn=le(Ut,[["__scopeId","data-v-52402bcc"]]);export{vn as default};
