import{E as U,a as A}from"./index.5c4c12e6.js";import{E as F}from"./index.222a6e13.js";import{a as P,O as V,S as L,q as p,ca as N,cb as R,a1 as y,cc as j,a6 as D,cd as b,K as m,o as d,h as f,f as S,w,N as I,c as q,e as g,F as O,r as K,t as z,y as G}from"./entry.c7e0e7b4.js";/* empty css                  */import{_ as H}from"./_plugin-vue_export-helper.c27b6911.js";const J=P({components:{},props:{type:{type:String,default:"image"},multiple:{type:Boolean,default:!0},limit:{type:Number,default:10},data:{type:Object,default:()=>({})},showProgress:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},emits:["change","error","success"],setup(e,{emit:a}){const v=V(),n=L(),h=p(`${N()}${R()}/upload/${e.type}`),E=y(()=>({token:v.token,version:j()})),o=p(!1),c=p([]),i=(s,l,r)=>{o.value=!0,c.value=D(r)},t=(s,l,r)=>{var _;r.every(B=>B.status=="success")&&((_=n.value)==null||_.clearFiles(),o.value=!1),a("change",l),s.code==b.SUCCESS&&a("success",s),s.code==b.FAIL&&s.msg&&m.msgError(s.msg)},u=(s,l)=>{var r;m.msgError(`${l.name}文件上传失败`),(r=n.value)==null||r.abort(l),o.value=!1,a("change",l),a("error",l)},k=()=>{m.msgError(`超出上传上限${e.limit}，请重新上传`)},C=()=>{var s;(s=n.value)==null||s.clearFiles(),o.value=!1},$=y(()=>{switch(e.type){case"image":return".jpg,.png,.gif,.jpeg";case"video":return".wmv,.avi,.mpg,.mpeg,.3gp,.mov,.mp4,.flv,.rmvb,.mkv";default:return"*"}});return{uploadRefs:n,action:h,headers:E,visible:o,fileList:c,getAccept:$,handleProgress:i,handleSuccess:t,handleError:u,handleExceed:k,handleClose:C}}});const M={class:"upload"},Q={class:"file-list p-4"},T={class:"flex-1"};function W(e,a,v,n,h,E){const o=U,c=A,i=F;return d(),f("div",M,[S(o,{class:"w-[inherit]",ref:"uploadRefs",action:e.action,multiple:e.multiple,limit:e.limit,disabled:e.disabled,"show-file-list":!1,headers:e.headers,data:e.data,"on-progress":e.handleProgress,"on-success":e.handleSuccess,"on-exceed":e.handleExceed,"on-error":e.handleError,accept:e.getAccept},{default:w(()=>[I(e.$slots,"default",{},void 0,!0)]),_:3},8,["action","multiple","limit","disabled","headers","data","on-progress","on-success","on-exceed","on-error","accept"]),e.showProgress&&e.fileList.length?(d(),q(i,{key:0,modelValue:e.visible,"onUpdate:modelValue":a[0]||(a[0]=t=>e.visible=t),title:"上传进度","close-on-click-modal":!1,width:"500px",modal:!1,onClose:e.handleClose},{default:w(()=>[g("div",Q,[(d(!0),f(O,null,K(e.fileList,(t,u)=>(d(),f("div",{key:u,class:"mb-5"},[g("div",null,z(t.name),1),g("div",T,[S(c,{percentage:parseInt(t.percentage)},null,8,["percentage"])])]))),128))])]),_:1},8,["modelValue","onClose"])):G("",!0)])}const ae=H(J,[["render",W],["__scopeId","data-v-d64aca4f"]]);export{ae as U};
