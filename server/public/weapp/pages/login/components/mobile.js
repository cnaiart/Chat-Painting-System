"use strict";const e=require("../../../common/vendor.js"),o=require("../../../api/app.js"),n=require("../../../enums/appEnums.js"),t=require("../../../stores/app.js"),s=require("../../../hooks/useCaptchaEffect.js");if(require("../../../utils/request/index.js"),require("../../../utils/request/http.js"),require("../../../enums/requestEnums.js"),require("../../../utils/request/cancel.js"),require("../../../stores/user.js"),require("../../../api/user.js"),require("../../../enums/constantEnums.js"),require("../../../mixins/share.js"),require("../../../api/task.js"),require("../../../utils/util.js"),require("../../../stores/navigationBarTitle.js"),require("../../../router/index.js"),require("../../../utils/cache.js"),require("../../../utils/auth.js"),require("../../../config/index.js"),require("../../../api/account.js"),require("../../../utils/client.js"),!Array){(e.resolveComponent("u-icon")+e.resolveComponent("u-input")+e.resolveComponent("u-form-item")+e.resolveComponent("u-verification-code")+e.resolveComponent("router-navigate")+e.resolveComponent("u-form")+e.resolveComponent("agreement")+e.resolveComponent("u-button"))()}Math||((()=>"../../../uni_modules/vk-uview-ui/components/u-icon/u-icon.js")+(()=>"../../../uni_modules/vk-uview-ui/components/u-input/u-input.js")+(()=>"../../../uni_modules/vk-uview-ui/components/u-form-item/u-form-item.js")+(()=>"../../../uni_modules/vk-uview-ui/components/u-verification-code/u-verification-code.js")+(()=>"../../../node-modules/uniapp-router-next/components/router-navigate/router-navigate.js")+(()=>"../../../uni_modules/vk-uview-ui/components/u-form/u-form.js")+(()=>"../../../components/agreement/agreement.js")+(()=>"../../../uni_modules/vk-uview-ui/components/u-button/u-button.js"))();const r=e.defineComponent({__name:"mobile",emits:["login"],setup(r,{emit:i}){const u=t.useAppStore(),{captchaKey:a,captchaImage:c,getCaptchaFn:p}=s.useCaptchaEffect(),m=e.shallowRef(),l=e.reactive({scene:2,mobile:"",captcha:"",code:"",password:""}),d=e.computed((()=>4===l.scene)),f=e.computed((()=>2===l.scene)),v=e.computed((()=>e.index.$u.test.mobile(l.mobile))),g=e=>{p(),l.scene=e},h=e.shallowRef(),j=e.ref(""),q=e=>{j.value=e},b=async()=>{var t,s;l.mobile&&v.value&&(l.captcha.length||!u.getLoginConfig.is_captcha?(null==(t=h.value)?void 0:t.canGetCode)&&(await o.smsSend({key:a.value,captcha:l.captcha,scene:n.SMSEnum.LOGIN,mobile:l.mobile}),e.index.$u.toast("发送成功"),null==(s=h.value)||s.start()):e.index.$u.toast("请先输入图形验证码"))},w=()=>{var o;if(null==(o=m.value)?void 0:o.checkAgreement()){if(!l.mobile)return e.index.$u.toast("请输入手机号码");if(2==l.scene&&!l.password)return e.index.$u.toast("请输入密码");if(4==l.scene&&!l.code)return e.index.$u.toast("请输入验证码");i("login",{...l,key:a.value,captcha:l.captcha}),setTimeout(p,200)}};return(o,n)=>e.e({a:e.p({size:36,name:"/static/images/icon/icon_mobile.png"}),b:e.o((e=>l.mobile=e)),c:e.p({border:!1,placeholder:"请输入手机号码",modelValue:l.mobile}),d:e.unref(u).getLoginConfig.is_captcha},e.unref(u).getLoginConfig.is_captcha?{e:e.p({size:36,name:"/static/images/icon/icon_code.png"}),f:e.o((e=>l.captcha=e)),g:e.p({placeholder:"图形验证码",border:!1,modelValue:l.captcha}),h:e.unref(c),i:e.o(((...o)=>e.unref(p)&&e.unref(p)(...o)))}:{},{j:e.unref(d)},e.unref(d)?{k:e.p({size:36,name:"/static/images/icon/icon_code.png"}),l:e.o((e=>l.code=e)),m:e.p({placeholder:"请输入验证码",border:!1,modelValue:l.code}),n:e.sr(h,"6baac69c-10,6baac69c-7",{k:"uCodeRef"}),o:e.o(q),p:e.p({seconds:60,"change-text":"x秒"}),q:e.t(j.value),r:e.n(e.unref(v)?"text-primary":"text-muted"),s:e.o(b)}:{},{t:e.unref(f)},e.unref(f)?{v:e.p({size:36,name:"/static/images/icon/icon_password.png"}),w:e.o((e=>l.password=e)),x:e.p({type:"password",placeholder:"请输入密码",border:!1,modelValue:l.password}),y:e.p({to:"/packages/pages/forget_pwd/forget_pwd?type=2"})}:{},{z:e.sr(m,"6baac69c-15",{k:"agreementRef"}),A:e.o(w),B:e.p({type:"primary",shape:"circle","hover-class":"none"}),C:e.unref(d)},e.unref(d)?{D:e.o((e=>g(2)))}:{},{E:e.unref(f)},e.unref(f)?{F:e.o((e=>g(4)))}:{},{G:e.p({to:"/packages/pages/register/register?type=2"})})}});wx.createComponent(r);
