"use strict";const e=require("../../../common/vendor.js"),t=require("../../../utils/util.js"),a=require("./hooks/useTouch.js");if(require("../../../stores/navigationBarTitle.js"),require("../../../router/index.js"),require("../../../stores/user.js"),require("../../../api/user.js"),require("../../../utils/request/index.js"),require("../../../utils/request/http.js"),require("../../../enums/requestEnums.js"),require("../../../utils/request/cancel.js"),require("../../../config/index.js"),require("../../../enums/constantEnums.js"),require("../../../mixins/share.js"),require("../../../api/task.js"),require("../../../stores/app.js"),require("../../../api/app.js"),require("../../../utils/auth.js"),require("../../../utils/cache.js"),!Array){(e.resolveComponent("u-badge")+e.resolveComponent("u-sticky"))()}Math||((()=>"../../../uni_modules/vk-uview-ui/components/u-badge/u-badge.js")+(()=>"../../../uni_modules/vk-uview-ui/components/u-sticky/u-sticky.js"))();const u=e.defineComponent({__name:"tabs",props:{isScroll:{type:Boolean,default:!0},current:{default:0},height:{default:80},fontSize:{default:28},duration:{default:.3},activeColor:{default:"#2073F4"},inactiveColor:{default:"#333"},barWidth:{default:40},barHeight:{default:4},gutter:{default:30},bgColor:{default:"#FFFFFF"},name:{default:"name"},count:{default:"count"},offset:{default:[5,20]},bold:{type:Boolean,default:!0},activeItemStyle:{default:{}},showBar:{type:Boolean,default:!0},barStyle:{default:{}},itemWidth:{default:"auto"},isFixed:{type:Boolean,default:!1},top:{default:0},stickyBgColor:{default:"#FFFFFF"},swipeable:{type:Boolean,default:!0}},emits:["change"],setup(u,{emit:r}){const i=u,{touch:o,resetTouchStatus:l,touchStart:n,touchMove:s}=a.useTouch(),d=e.ref([]),c=e.ref([]),f=e.ref(0),v=e.ref([]),h=e.ref(0),p=e.ref(0),g=e.ref(0),m=e.ref("cu-tab"),b=e.ref(i.current),x=e.ref(!0),j=e.ref(!1),q=e.getCurrentInstance();e.watch((()=>d.value),(async(t,a)=>{x.value||t.length===a.length||(b.value=0),await e.nextTick$1(),C()})),e.watch((()=>i.current),((t,a)=>{e.nextTick$1((()=>{b.value=t,S()}))}),{immediate:!0});const w=e.computed((()=>{const e={width:i.barWidth+"rpx",transform:`translate(${p.value}px, -100%)`,"transition-duration":`${x.value?0:i.duration}s`,"background-color":i.activeColor,height:i.barHeight+"rpx",opacity:x.value?0:1,"border-radius":i.barHeight/2+"px"};return Object.assign(e,i.barStyle),e})),y=e.computed((()=>e=>{let t={height:i.height+"rpx","line-height":i.height+"rpx","font-size":i.fontSize+"rpx",padding:i.isScroll?`0 ${i.gutter}rpx`:"",flex:i.isScroll?"auto":"1",width:`${i.itemWidth}rpx`};return e==b.value&&i.bold&&(t.fontWeight="bold"),e==b.value?(t.color=i.activeColor,t=Object.assign(t,i.activeItemStyle)):t.color=i.inactiveColor,t})),k=()=>{d.value=c.value.map((e=>{const{name:t,dot:a,active:u,inited:r}=e.event,{updateRender:i}=e;return{name:t,dot:a,active:u,inited:r,updateRender:i}}))},C=async()=>{const e=await t.getRect("#"+m.value,!1,q);g.value=e.left,h.value=e.width,F()},F=()=>{const t=e.index.createSelectorQuery().in(q);for(let e=0;e<d.value.length;e++)t.select(`#tab-item-${e}`).fields({size:!0,rect:!0});t.exec((e=>{v.value=e,S()}))},S=()=>{const t=v.value[b.value];if(!t)return;const a=t.width,u=t.left-g.value-(h.value-a)/2;f.value=u<0?0:u;const r=t.left+t.width/2-g.value;p.value=r-e.index.upx2px(i.barWidth)/2,1==x.value&&setTimeout((()=>{x.value=!1}),100),c.value.forEach(((e,t)=>{const a=t===b.value;a===e.event.active&&e.event.inited||e.updateRender(a)}))},B=e=>{i.swipeable&&(j.value=!0,n(e))},T=e=>{i.swipeable&&j.value&&s(e)},$=()=>{if(!i.swipeable||!j.value)return;if("horizontal"===o.direction&&o.offsetX>=50){let t,a=d.value.length,u=b.value;t=o.deltaX<=0?u>=a-1?0:u+1:u<=0?a-1:u-1,e.nextTick$1((()=>{b.value=t,S()})),r("change",t)}j.value=!1};return e.onMounted((()=>{k()})),e.provide("handleChange",((e,t)=>{c.value.push({event:e,updateRender:t})})),e.provide("updateTabs",k),(t,a)=>e.e({a:e.f(d.value,((t,a,i)=>({a:"f0ddd60c-1-"+i+",f0ddd60c-0",b:e.p({count:t[u.count]||t.dot||0,offset:u.offset,size:"mini"}),c:e.t(t[u.name]||t.name),d:"tab-item-"+a,e:a,f:e.o((t=>(t=>{t!=b.value&&(e.nextTick$1((()=>{b.value=t,S()})),r("change",t))})(a)),a),g:e.s(e.unref(y)(a))}))),b:u.showBar},u.showBar?{c:e.s(e.unref(w))}:{},{d:u.isScroll?"":1,e:u.height+"rpx",f:f.value,g:m.value,h:u.bgColor,i:e.p({enable:u.isFixed,"bg-color":u.stickyBgColor,"offset-top":u.top,"h5-nav-height":0}),j:e.o(B),k:e.o(T),l:e.o($),m:e.o($)})}}),r=e._export_sfc(u,[["__scopeId","data-v-f0ddd60c"]]);wx.createComponent(r);
