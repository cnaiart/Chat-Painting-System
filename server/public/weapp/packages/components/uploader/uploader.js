"use strict";const e=require("../../../common/vendor.js"),a=require("../../../api/app.js"),r=require("../../../utils/util.js");if(require("../../../utils/request/index.js"),require("../../../utils/request/http.js"),require("../../../enums/requestEnums.js"),require("../../../utils/request/cancel.js"),require("../../../stores/user.js"),require("../../../api/user.js"),require("../../../enums/constantEnums.js"),require("../../../mixins/share.js"),require("../../../api/task.js"),require("../../../stores/app.js"),require("../../../router/index.js"),require("../../../utils/cache.js"),require("../../../utils/auth.js"),require("../../../config/index.js"),require("../../../stores/navigationBarTitle.js"),!Array){e.resolveComponent("u-icon")()}Math;const t=e.defineComponent({__name:"uploader",props:{modelValue:{default:[]},uploadViewStyle:{default:{}},maxUpload:{default:1},previewSize:{default:"160"},deletable:{type:Boolean,default:!1},tips:{default:"上传图片"},imageFit:{default:"aspectFill"},maxSize:{default:20}},emits:["update:modelValue","change"],setup(t,{emit:u}){const i=t,s=e.computed$1({get:()=>i.modelValue,set:e=>{u("update:modelValue",e)}}),l=async()=>{try{const{tempFiles:r}=await e.index.chooseImage({count:i.maxUpload,sourceType:["album","camera"]});for(const{path:t,size:l}of r){if(l>=1024*i.maxSize*1024)return e.index.$u.toast("选择的文件超出大小！"),new Error("文件超出大小～");const r=await a.uploadImage(t);s.value.push(r.uri),u("change",s.value)}}catch(r){console.log(r)}};return(a,i)=>e.e({a:t.maxUpload>e.unref(s).length},t.maxUpload>e.unref(s).length?{b:e.p({size:"48",color:"#dcdee0",name:"camera"}),c:e.t(e.unref(s).length>=1?e.unref(s).length+"/"+t.maxUpload:t.tips),d:e.o(l),e:e.s(t.uploadViewStyle)}:{},{f:e.f(e.unref(s),((a,r,i)=>e.e(t.deletable?{a:"d2d5bd67-1-"+i,b:e.p({name:"close",size:"20",color:"#FFFFFF"}),c:e.o((e=>(e=>{s.value.splice(e,1),u("update:modelValue",s.value),u("change",s.value)})(r)),r)}:{},{d:e.o((a=>((a,r)=>{e.index.previewImage({urls:s.value,current:r})})(0,r)),r),e:a,f:r}))),g:t.deletable,h:t.imageFit,i:e.unref(r.addUnit)(t.previewSize),j:e.unref(r.addUnit)(t.previewSize)})}}),u=e._export_sfc(t,[["__scopeId","data-v-d2d5bd67"]]);wx.createComponent(u);
