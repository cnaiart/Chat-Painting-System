"use strict";const e=require("../../../common/vendor.js"),t=require("../../../api/shop.js"),s=require("../../../enums/appEnums.js"),u=require("../../../stores/user.js"),r=require("../../../common/assets.js");if(require("../../../utils/client.js"),require("../../../utils/request/index.js"),require("../../../utils/request/http.js"),require("../../../enums/requestEnums.js"),require("../../../utils/request/cancel.js"),require("../../../router/index.js"),require("../../../utils/cache.js"),require("../../../enums/constantEnums.js"),require("../../../config/index.js"),require("../../../api/user.js"),require("../../../mixins/share.js"),require("../../../api/task.js"),require("../../../utils/util.js"),require("../../../stores/navigationBarTitle.js"),require("../../../stores/app.js"),require("../../../api/app.js"),require("../../../utils/auth.js"),!Array){(e.resolveComponent("u-loading")+e.resolveComponent("u-image")+e.resolveComponent("u-button")+e.resolveComponent("page-status"))()}Math||((()=>"../../../uni_modules/vk-uview-ui/components/u-loading/u-loading.js")+(()=>"../../../uni_modules/vk-uview-ui/components/u-image/u-image.js")+(()=>"../../../uni_modules/vk-uview-ui/components/u-button/u-button.js")+a+(()=>"../../../components/page-status/page-status.js")+o)();const o=()=>"./component/invite-poster.js",a=()=>"../../../uni_modules/vk-uview-ui/components/u-empty/u-empty.js",n=e.defineComponent({__name:"invite_poster",setup(o){const a=u.useUserStore();e.storeToRefs(a);const n=e.shallowRef(),i=e.reactive({status:s.PageStatusEnum.LOADING,status_text:"服务器请求错误，请稍后再试",poster_params:{code:{x:"",y:""},data:{content:"邀请您前来体验",x:"",y:""},default:1,defaultUrl1:"",defaultUrl2:"",poster:1,posterUrl:"",showData:1},rule_desc:{enabled:1,name:"邀请说明",data:""},poster_url:""}),l=async()=>{var u,r;await e.index.showLoading({title:"生成中"});try{const o=await t.getDecorate({id:5}),a=JSON.parse(o.data);i.poster_params=(null==(u=a[0])?void 0:u.content)||{},i.rule_desc=(null==(r=a[1])?void 0:r.content)||{},await e.nextTick$1(),i.status=s.PageStatusEnum.NORMAL,await n.value.initPosterData()}catch(o){e.index.hideLoading(),i.status_text=o,i.status=s.PageStatusEnum.ERROR,console.log("获取邀请海报装修失败",o)}},p=()=>{e.index.saveImageToPhotosAlbum({filePath:i.poster_url,success:()=>{e.index.$u.toast("保存成功")},fail:t=>{e.index.$u.toast("保存失败"),console.log(t)}})};return e.onMounted((async()=>{await l()})),e.onPullDownRefresh((async()=>{l(),e.index.stopPullDownRefresh()})),(t,s)=>{var u,o,a,l;return e.e({a:t.$theme.navColor,b:t.$theme.navBgColor,c:t.$theme.pageStyle,d:e.p({width:"540",height:"900",src:i.poster_url}),e:null==(u=null==i?void 0:i.rule_desc)?void 0:u.enabled},(null==(o=null==i?void 0:i.rule_desc)?void 0:o.enabled)?{f:e.t(null==(a=null==i?void 0:i.rule_desc)?void 0:a.name),g:e.t(null==(l=null==i?void 0:i.rule_desc)?void 0:l.data)}:{},{h:e.o(p),i:e.p({type:"primary",shape:"circle",size:"default",customStyle:{padding:"0 30rpx",height:"82rpx"}}),j:e.p({"font-size":"28","icon-size":"300",text:i.status_text,src:e.unref(r.EmptyErrorImage)}),k:e.p({status:i.status}),l:e.sr(n,"fd78fa5d-6",{k:"posterRef"}),m:e.o((e=>{i.poster_url=e})),n:e.p({options:i.poster_params})})}}}),i=e._export_sfc(n,[["__scopeId","data-v-fd78fa5d"]]);wx.createPage(i);
