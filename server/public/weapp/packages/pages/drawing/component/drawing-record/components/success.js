"use strict";const e=require("../../../../../../common/vendor.js"),a=require("../../../../../../common/assets.js"),i=require("../../../hooks/useSplit.js"),o=require("../../../../../../stores/app.js"),u=require("../../../../../../utils/file.js"),l=require("../../../../../../hooks/useCopy.js");if(require("../../../../../../api/app.js"),require("../../../../../../utils/request/index.js"),require("../../../../../../utils/request/http.js"),require("../../../../../../enums/requestEnums.js"),require("../../../../../../utils/request/cancel.js"),require("../../../../../../stores/user.js"),require("../../../../../../api/user.js"),require("../../../../../../enums/constantEnums.js"),require("../../../../../../mixins/share.js"),require("../../../../../../api/task.js"),require("../../../../../../utils/util.js"),require("../../../../../../stores/navigationBarTitle.js"),require("../../../../../../router/index.js"),require("../../../../../../utils/cache.js"),require("../../../../../../utils/auth.js"),require("../../../../../../config/index.js"),!Array){e.resolveComponent("u-tag")()}Math||(s+(()=>"../../../../../../uni_modules/vk-uview-ui/components/u-tag/u-tag.js"))();const s=()=>"./picture.js",n=e.defineComponent({__name:"success",props:{value:{default:""}},setup(s){const n=e.inject("pageIndex"),r=e.inject("drawForm"),t=e.inject("deleteDrawing"),c=e.inject("drawingHandler"),v=o.useAppStore(),d=e.ref(!1),{copy:m}=l.useCopy(),p=(e,a)=>{const i=e;i.action="upsample"+a,i.model=e.model,console.log(i),c({drawing:i,isClear:!1})},g=(e,a)=>{const i=e;i.action="variation"+a,i.model=e.model,c({drawing:i,isClear:!1})},_=async(a,i)=>{const o=Object.assign({},a);i&&(o.is_base64=1),e.index.$emit("shareSquare",o)};return(o,l)=>{var c,q,j,f,h,w,y,x,C,I,A,b,S,D;return e.e({a:e.unref(a.IconCopy),b:e.o((e=>(async e=>{await m(e)})(s.value.prompt_desc))),c:e.unref(a.IconDownload),d:e.o((a=>(async a=>{Array.isArray(a.image)?e.index.$u.toast("请点击自己想要保存的图片后长按保存～"):u.saveImageToPhotosAlbum(a.image)})(s.value))),e:e.unref(a.IconReload),f:e.o((e=>(async e=>{n.value=0,r.prompt=e.prompt,r.image_id="",r.other=e.prompt_other,r.scale=e.scale,r.model=e.model,r.no_content=e.no_content,r.style=e.style,r.quality=e.quality,r.image_base=e.image_base})(s.value))),g:!(null==(c=s.value.actions)?void 0:c.includes("low_variation"))&&(null==(q=s.value.actions)?void 0:q.length)},!(null==(j=s.value.actions)?void 0:j.includes("low_variation"))&&(null==(f=s.value.actions)?void 0:f.length)?{h:e.unref(a.IconCutout),i:e.o((a=>(async a=>{if(!d.value)if(Array.isArray(a.image))e.index.$u.toast("已经切片完成了～");else{e.index.showLoading({title:"切图中"}),d.value=!0;try{const{getImages:e}=i.useSplit(a.image||a.image_url,{columns:2,rows:2}),o=await e();a.image=o}catch(o){console.log("一键切图失败=>",o)}finally{e.index.hideLoading(),d.value=!1}}})(s.value)))}:{},{j:e.unref(v).getDrawSquareConfig.is_allow_share},e.unref(v).getDrawSquareConfig.is_allow_share?{k:e.unref(a.IconShare),l:e.o((e=>_(s.value)))}:{},{m:e.unref(a.IconDelete),n:e.o((e=>(async e=>{t([e.id])})(s.value))),o:e.o((e=>_(s.value,e))),p:e.p({picture:s.value.image||s.value.image_url,"lazy-img":s.value.thumbnail}),q:s.value.prompt_desc},s.value.prompt_desc?{r:e.t(s.value.prompt)}:{},{s:s.value.fail_reason&&2==s.value.censor_status},s.value.fail_reason&&2==s.value.censor_status?{t:e.t(s.value.fail_reason),v:e.o((a=>e.unref(m)(s.value.fail_reason)))}:e.e({w:!(null==(h=s.value.actions)?void 0:h.includes("low_variation"))&&(null==(y=null==(w=s.value)?void 0:w.actions)?void 0:y.length)},!(null==(x=s.value.actions)?void 0:x.includes("low_variation"))&&(null==(I=null==(C=s.value)?void 0:C.actions)?void 0:I.length)?{x:e.o((e=>p(s.value,1))),y:e.o((e=>p(s.value,2))),z:e.o((e=>p(s.value,3))),A:e.o((e=>p(s.value,4)))}:{},{B:!(null==(A=s.value.actions)?void 0:A.includes("low_variation"))&&(null==(b=s.value.actions)?void 0:b.length)},!(null==(S=s.value.actions)?void 0:S.includes("low_variation"))&&(null==(D=s.value.actions)?void 0:D.length)?{C:e.o((e=>g(s.value,1))),D:e.o((e=>g(s.value,2))),E:e.o((e=>g(s.value,3))),F:e.o((e=>g(s.value,4)))}:{}),{G:e.t(s.value.create_time),H:e.p({text:s.value.draw_model,mode:"light",size:"mini"})})}}}),r=e._export_sfc(n,[["__scopeId","data-v-d019707c"]]);wx.createComponent(r);
