"use strict";const e=require("../common/vendor.js"),l=new Set;exports.useAudio=()=>{const a=e.shallowRef(null),u=e.ref(!1),o=e.ref(0),n=()=>{u.value=!0},v=()=>{u.value=!1},r=e=>{console.error(e),u.value=!1},t=()=>{var e;o.value=(null==(e=a.value)?void 0:e.duration)||0,0==o.value&&setTimeout((()=>{var e;o.value=(null==(e=a.value)?void 0:e.duration)||0}),100)},s=()=>{a.value=e.index.createInnerAudioContext(),l.add(a.value),a.value.onCanplay(t),a.value.onPlay(n),a.value.onEnded(v),a.value.onError(r),a.value.onStop(v)},d=e=>{a.value||s(),a.value.src=e},i=()=>{var e;null==(e=a.value)||e.stop()},p=()=>{l.forEach((e=>{e.paused||e.stop()}))};return e.onBeforeUnmount((()=>{u.value&&i(),a.value&&(a.value.destroy(),l.delete(a.value),a.value=null)})),{pause:i,pauseAll:p,play:async e=>{p(),a.value||s(),e&&d(e),a.value.play()},duration:o,isPlaying:u,setUrl:d}};
