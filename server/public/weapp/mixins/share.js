"use strict";const e=require("../common/vendor.js"),t=require("../api/task.js"),r=require("../utils/util.js"),a=require("../stores/app.js"),i=require("../router/index.js"),s={onShow(){e.useRoute().meta.share||e.index.hideShareMenu({hideShareItems:[]})},async onShareAppMessage(){const e=a.useAppStore(),t=await n({...e.getShareConfig,...e.getWebsiteConfig});return{title:t.title,path:t.link,imageUrl:t.img_url}},async onShareTimeline(){const e=a.useAppStore(),t=await n({...e.getShareConfig,...e.getWebsiteConfig}),r=i.router.currentRoute.value;return{title:t.title,query:r.query,imageUrl:t.img_url}}};async function n(t){e.index.showLoading({title:"请稍后..."});const{share_title:r,share_image:a,share_content:i,shop_name:s,share_page:n}=t,u=await o(2==n);return e.index.hideLoading(),{title:r||s,link:u,img_url:a,desc:i}}async function o(e=!1){a.useAppStore();const s=i.router.currentRoute.value;const n={path:e?"/pages/index/index":s.path,query:e?{}:s.query},o=`${n.path}`,u=n.query;try{const{share_id:e}=await t.getShareId();e&&(u.share_id=e)}catch(h){}return`${o}${r.paramsToStr(u)}`}exports.createShareOptions=n,exports.generateSharePath=o,exports.share=s,exports.useSharedId=async function(){const r=e.index.getEnterOptionsSync().query.share_id;r&&await t.shareClick({share_id:r})};
